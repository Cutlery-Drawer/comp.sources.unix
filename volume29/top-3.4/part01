Newsgroups: comp.sources.unix
From: wnl@groupsys.com (William Lefebvre)
Subject: v29i102: top-3.4 - top process display, V3.4, Part01/22
Message-id: <1.841608857.22962@gw.home.vix.com>
Sender: unix-sources-moderator@gw.home.vix.com
Approved: vixie@gw.home.vix.com

Submitted-By: wnl@groupsys.com (William Lefebvre)
Posting-Number: Volume 29, Issue 102
Archive-Name: top-3.4/part01

#! /bin/sh
# This is a shell archive.  Remove anything before this line, then unpack
# it by saving it into a file and typing "sh file".  To overwrite existing
# files, type "sh file -c".  You can also feed this as standard input via
# unshar, or by typing "sh <file", e.g..  If this archive is complete, you
# will see the following message at the end:
#		"End of archive 1 (of 22)."
# Contents:  top-3.4 top-3.4/ADVERTISEMENT top-3.4/DISCLAIMER
#   top-3.4/Make.desc.X top-3.4/Makefile.X top-3.4/boolean.h
#   top-3.4/display.h top-3.4/getans top-3.4/getopt.c top-3.4/install
#   top-3.4/layout.h top-3.4/loadavg.h top-3.4/machine
#   top-3.4/machine.h top-3.4/machine/m_386bsd.man
#   top-3.4/machine/m_aix41.man top-3.4/machine/m_aux3.man
#   top-3.4/machine/m_bsd44.man top-3.4/machine/m_bsd44a.man
#   top-3.4/machine/m_bsdos2.man top-3.4/machine/m_convex.man
#   top-3.4/machine/m_dcosx.man top-3.4/machine/m_dgux.man
#   top-3.4/machine/m_dynix.man top-3.4/machine/m_freebsd20.man
#   top-3.4/machine/m_ftx.man top-3.4/machine/m_hpux9.man
#   top-3.4/machine/m_linux.man top-3.4/machine/m_ncr3000.man
#   top-3.4/machine/m_netbsd08.man top-3.4/machine/m_next40.c
#   top-3.4/machine/m_next_task.h top-3.4/machine/m_sco.man
#   top-3.4/machine/m_sunos4.man top-3.4/machine/m_sunos5.man
#   top-3.4/machine/m_sunos54.c top-3.4/machine/m_svr4.man
#   top-3.4/machine/m_svr42.man top-3.4/machine/m_umax.man
#   top-3.4/metatop top-3.4/os.h top-3.4/patchlevel.h top-3.4/prime.c
#   top-3.4/screen.h top-3.4/sigconv.awk top-3.4/top.h
#   top-3.4/top.local.H top-3.4/utils.h top-3.4/version.c
# Wrapped by lefebvre@acapulco on Fri Aug 30 12:35:49 1996
PATH=/bin:/usr/bin:/usr/ucb ; export PATH
if test ! -d 'top-3.4' ; then
    echo shar: Creating directory \"'top-3.4'\"
    mkdir 'top-3.4'
fi
if test -f 'top-3.4/ADVERTISEMENT' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/ADVERTISEMENT'\"
else
echo shar: Extracting \"'top-3.4/ADVERTISEMENT'\" \(784 characters\)
sed "s/^X//" >'top-3.4/ADVERTISEMENT' <<'END_OF_FILE'
X					William LeFebvre
X					Group sys Consulting
X					wnl@groupsys.com
X					+1-770-813-3224
X
X
XWilliam LeFebvre is available for consulting and teaching engagements
Xthrough the company Group sys Consulting.  William's specialties are:
X
X	Unix system administration issues
X	Local area network design
X	Design of safe connections to the Internet
X	Domain Name Service
X	Unix and Internet security
X	INN news server configuration
X	SunOS to Solaris migration
X	Troubleshooting
X
X
XAlthough located in the Atlanta metropolitan area, William can easily
Xtravel to any location in the United States and Canada.  Trips to
Xother countries can be arranged as well.
X
XIf you are interested in having William work for your organization,
Xcontact him at +1-770-813-3224 or via the address "wnl@groupsys.com".
X
END_OF_FILE
if test 784 -ne `wc -c <'top-3.4/ADVERTISEMENT'`; then
    echo shar: \"'top-3.4/ADVERTISEMENT'\" unpacked with wrong size!
fi
# end of 'top-3.4/ADVERTISEMENT'
fi
if test -f 'top-3.4/DISCLAIMER' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/DISCLAIMER'\"
else
echo shar: Extracting \"'top-3.4/DISCLAIMER'\" \(1498 characters\)
sed "s/^X//" >'top-3.4/DISCLAIMER' <<'END_OF_FILE'
XDISCLAIMER
X
X"top" is distributed free of charge.  It should not be considered an
Xofficial product of Argonne National Laboratory.  William LeFebvre
Xsupports "top" in his spare time and as time permits.
X
XNO WARRANTY:
X
XBECAUSE "top" IS DISTRIBUTED FREE OF CHARGE, THERE IS ABSOLUTELY NO
XWARRANTY PROVIDED, TO THE EXTENT PERMITTED BY APPLICABLE STATE LAW.
XEXCEPT WHEN OTHERWISE STATED IN WRITING, ARGONNE NATIONAL LABORATORY,
XNORTHWESTERN UNIVERSITY, WILLIAM N. LeFEBVRE AND/OR OTHER PARTIES
XPROVIDE "top" "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED
XOR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
XMERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK
XAS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD
XTHE "top" PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL
XNECESSARY SERVICING, REPAIR OR CORRECTION.
X 
XIN NO EVENT WILL ARGONNE NATIONAL LABORATORY, NORTHWESTERN UNIVERSITY,
XWILLIAM N. LeFEBVRE, AND/OR ANY OTHER PARTY WHO MAY MODIFY AND
XREDISTRIBUTE "top", BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY LOST
XPROFITS, LOST MONIES, OR OTHER SPECIAL, INCIDENTAL OR CONSEQUENTIAL
XDAMAGES ARISING OUT OF THE USE OR INABILITY TO USE (INCLUDING BUT NOT
XLIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES
XSUSTAINED BY THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH
XOTHER PROGRAMS) THE PROGRAM, EVEN IF YOU HAVE BEEN ADVISED OF THE
XPOSSIBILITY OF SUCH DAMAGES, OR FOR ANY CLAIM BY ANY OTHER PARTY.
X
XSo there!
END_OF_FILE
if test 1498 -ne `wc -c <'top-3.4/DISCLAIMER'`; then
    echo shar: \"'top-3.4/DISCLAIMER'\" unpacked with wrong size!
fi
# end of 'top-3.4/DISCLAIMER'
fi
if test -f 'top-3.4/Make.desc.X' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/Make.desc.X'\"
else
echo shar: Extracting \"'top-3.4/Make.desc.X'\" \(673 characters\)
sed "s/^X//" >'top-3.4/Make.desc.X' <<'END_OF_FILE'
X# Makefile for .desc files
X
X# This makefile is the prototype for "Make.desc", which is used by
X# top's Configure script to build .desc files and the SYNOPSIS file.
X# Configure then uses these files to ask appropriate questions.
X
X# Written by William LeFebvre, Argonne National Laboratory
X#	     (formerly of Northwestern University and Rice University)
X
X# DO NOT EDIT "Make.desc"!!!  Make changes to "Make.desc.X",
X# then "make veryclean", then run "Configure".
X
XDESCS=%descs%
X
X.SUFFIXES: .desc
X
X.c.desc:
X	sed -e '/^$$/,$$d' -e 's,^[/ *]*,,' $< > $@
X
Xall: SYNOPSIS
X
XSYNOPSIS: $(DESCS)
X	grep SYNOPSIS: $(DESCS) | sed -e 's@^machine/m_@@' -e 's@.desc:.[^:]*: *@:@' >SYNOPSIS
END_OF_FILE
if test 673 -ne `wc -c <'top-3.4/Make.desc.X'`; then
    echo shar: \"'top-3.4/Make.desc.X'\" unpacked with wrong size!
fi
# end of 'top-3.4/Make.desc.X'
fi
if test -f 'top-3.4/Makefile.X' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/Makefile.X'\"
else
echo shar: Extracting \"'top-3.4/Makefile.X'\" \(3841 characters\)
sed "s/^X//" >'top-3.4/Makefile.X' <<'END_OF_FILE'
X# Makefile for "top", a top 10 process display for Unix
X#
X# This makefile is for top, version 3
X#
X# Written by William LeFebvre, Argonne National Laboratory
X#		(formerly of Northwestern University and Rice University)
X
X# DO NOT EDIT "Makefile"!!!!  Make changes to "Makefile.X" and rerun
X# Configure.
X
X# Executables (these should be obvious):
X
XSHELL   = %shell%
XCC      = %cc%
XAWK     = %awk%
XINSTALL = %install%
X
X# installation information:
X#	OWNER	- name (or uid) for the installed executable's owner
X#	GROUP	- group name (or gid) for the installed executable's group
X#	MODE	- mode for the installed executable (should start with a 0)
X#	BINDIR	- directory where the executable should live
X#	MANDIR	- directory where the manual page should live
X#	MANEXT	- installed man pages end in .$(MANEXT)
X#	MANSTY	- "man" or "catman" depending on what's to be installed
X#	SIGNAL	- <signal.h> or <sys/signal.h>; the one with signal definitions
X#	TROFF	- most appropriate troff command
X
XOWNER  = %owner%
XGROUP  = %group%
XMODE   = %mode%
XBINDIR = %bindir%
XMANDIR = %mandir%
XMANEXT = %manext%
XMANSTY = %mansty%
XSIGNAL = %signal%
X
X# Values for the two defaults in "top":
X#	TOPN	- default number of processes to display
X#	DELAY	- default delay between updates
X#
X# set TOPN to -1 to indicate infinity (so that top will display as many
X# as the screen will hold).
X
XTOPN = %topn%
XDELAY = %delay%
X
XTARFILES = README INSTALL DISCLAIMER FAQ ADVERTISEMENT \
X	   Changes Configure Porting \
X	   Makefile.X Make.desc.X getans install \
X	   top.c commands.c display.c screen.c username.c \
X	   utils.c version.c getopt.c prime.c \
X	   boolean.h display.h layout.h loadavg.h screen.h \
X	   machine.h patchlevel.h top.h top.local.H os.h utils.h \
X	   sigconv.awk top.X m-template metatop \
X	   machine
XCFILES = top.c commands.c display.c screen.c username.c \
X	 utils.c version.c getopt.c machine.c
XOBJS = top.o commands.o display.o screen.o username.o \
X       utils.o version.o getopt.o machine.o
X
XCDEFS = %cdefs%
XLIBS = %libs%
XTERMCAP = %termcap%
X
XCFLAGS = %cflgs% $(CDEFS)
XLINTFLAGS = -x $(CDEFS)
X
Xall: Makefile top.local.h top
X
XMakefile: Makefile.X
X	@echo 'You need to run the script "Configure" before running "make".'
X	exit 10
X
Xtop.local.h: top.local.H
X	@echo 'You need to run the script "Configure" before running "make".'
X	exit 10
X
Xtop: $(OBJS)
X	rm -f top
X	$(CC) -o top $(OBJS) $(TERMCAP) -lm $(LIBS)
X
Xlint: sigdesc.h
X	$(LINT) $(LINTFLAGS) $(CFILES)
X
X# include file dependencies
Xtop.o: boolean.h display.h screen.h top.h top.local.h utils.h machine.h 
Xcommands.o: boolean.h sigdesc.h utils.h
Xdisplay.o: boolean.h display.h layout.h screen.h top.h top.local.h utils.h
Xmachine.o: top.h machine.h utils.h
Xscreen.o: boolean.h screen.h
Xutils.o: top.h
Xversion.o: top.h patchlevel.h
Xusername.o: top.local.h utils.h
X
X# automatically built include file
Xsigdesc.h: sigconv.awk $(SIGNAL)
X	$(AWK) -f sigconv.awk $(SIGNAL) >sigdesc.h
X
Xtar:
X	rm -f top.tar machine/*.desc machine/*~
X	tar cvf top.tar $(TARFILES)
X
Xshar:
X	rm -f top.shar* machine/*.desc
X	makekit -ntop.shar. -t"Now read README and INSTALL, then run Configure" machine $(TARFILES)/*
X
Xclean:
X	rm -f *.o top core core.* sigdesc.h
X
Xveryclean: clean
X	rm -f Make.desc machine/*.desc .defaults top.tar SYNOPSIS Makefile top.local.h top.1 machine.c prime
X
Xinstall: top top.1 install-top install-$(MANSTY)
X
Xinstall-top:
X	$(INSTALL) -o $(OWNER) -m $(MODE) -g $(GROUP) top $(BINDIR)
X
Xinstall-man:
X	$(INSTALL) top.1 $(MANDIR)/top.$(MANEXT)
X
Xinstall-catman:
X	tbl top.1 | nroff -man > $(MANDIR)/top.$(MANEXT)
X
Xinstallmeta: top top.1
X	$(INSTALL) -o $(OWNER) -m 755 -g $(GROUP) metatop $(BINDIR)/top
X	@echo $(INSTALL) -o $(OWNER) -m $(MODE) -g $(GROUP) top $(BINDIR)/top-`uname -m`-`uname -r`
X	@$(INSTALL) -o $(OWNER) -m $(MODE) -g $(GROUP) \
X		top $(BINDIR)/top-`uname -m`-`uname -r`
X	$(INSTALL) top.1 $(MANDIR)/top.$(MANEXT)
END_OF_FILE
if test 3841 -ne `wc -c <'top-3.4/Makefile.X'`; then
    echo shar: \"'top-3.4/Makefile.X'\" unpacked with wrong size!
fi
# end of 'top-3.4/Makefile.X'
fi
if test -f 'top-3.4/boolean.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/boolean.h'\"
else
echo shar: Extracting \"'top-3.4/boolean.h'\" \(125 characters\)
sed "s/^X//" >'top-3.4/boolean.h' <<'END_OF_FILE'
X/* My favorite names for boolean values */
X#define  No	0
X#define  Yes	1
X#define  Maybe	2		/* tri-state boolean, actually */
X
END_OF_FILE
if test 125 -ne `wc -c <'top-3.4/boolean.h'`; then
    echo shar: \"'top-3.4/boolean.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/boolean.h'
fi
if test -f 'top-3.4/display.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/display.h'\"
else
echo shar: Extracting \"'top-3.4/display.h'\" \(135 characters\)
sed "s/^X//" >'top-3.4/display.h' <<'END_OF_FILE'
X/* constants needed for display.c */
X
X/* "type" argument for new_message function */
X
X#define  MT_standout  1
X#define  MT_delayed   2
X
END_OF_FILE
if test 135 -ne `wc -c <'top-3.4/display.h'`; then
    echo shar: \"'top-3.4/display.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/display.h'
fi
if test -f 'top-3.4/getans' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/getans'\"
else
echo shar: Extracting \"'top-3.4/getans'\" \(1618 characters\)
sed "s/^X//" >'top-3.4/getans' <<'END_OF_FILE'
X#!/bin/csh -f
Xset ny = (no yes)
Xif ($2 == "yesno") then
X    @ i = $3 + 1
X    set pmpt = "$1 [$ny[$i]]: "
Xelse
X    if ("$3" == "") then
X        set pmpt = "${1}"
X    else
X        set pmpt = "$1 [$3]: "
X    endif
Xendif
Xrpt:
Xecho -n "$pmpt"
Xset input = $<
Xswitch ($2)
X    case number:
X	set tmp = `echo $input | tr -d 0123456789.`
X	if ("x$tmp" != x) then
X	    echo "Invalid number.  Please try again."
X	    goto rpt
X	endif
X	breaksw
X
X    case integer:
X	set tmp = `echo $input | tr -d 0123456789`
X	if ("x$tmp" != x) then
X	    echo "Invalid integer.  Please try again."
X	    goto rpt
X	endif
X	breaksw
X
X    case neginteger:
X	if ("x$input" != x-1) then
X	    set tmp = `echo $input | tr -d 0123456789`
X	    if ("x$tmp" != x) then
X	        echo "Invalid integer.  Please try again."
X	        goto rpt
X	    endif
X	endif
X	breaksw
X
X    case file:
X	if ("x$input" == "x") then
X	    set input = $3
X	endif
X	if (! -e "$input") then
X	    echo The file $input "does not exist.  Please try again."
X	    goto rpt
X	endif
X	breaksw
X
X    case path:
X	if ("x$input" == "x") then
X	    set input = "$3"
X	endif
X	if (! -e "$input") then
X	    foreach elt ($path)
X		if (-e "$elt/$input") breaksw
X	    end
X	    echo The command $input "was not found.  Please try again."
X	    goto rpt
X	endif
X	breaksw
X
X    case yesno:
X	if ("x$input" == xy || "x$input" == xyes) then
X	   set input = 1
X	else if ("x$input" == xn || "x$input" == xno) then
X	   set input = 0
X	else if ("x$input" != x) then
X	   echo 'Please answer "yes" or "no".'
X	   goto rpt
X	endif
X	breaksw
X
X    default:
X	breaksw
X
Xendsw
X
Xif ("x$input" == x) then
X    set input = "$3"
Xendif
X
Xecho $input > $4
END_OF_FILE
if test 1618 -ne `wc -c <'top-3.4/getans'`; then
    echo shar: \"'top-3.4/getans'\" unpacked with wrong size!
fi
chmod +x 'top-3.4/getans'
# end of 'top-3.4/getans'
fi
if test -f 'top-3.4/getopt.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/getopt.c'\"
else
echo shar: Extracting \"'top-3.4/getopt.c'\" \(1872 characters\)
sed "s/^X//" >'top-3.4/getopt.c' <<'END_OF_FILE'
X/*
X * "getopt" routine customized for top.
X */
X
X/*
X * Many modern-day Unix implementations already have this function
X * in libc.  The standard "getopt" is perfectly sufficient for top's
X * needs.  If such a function exists in libc then you certainly don't
X * need to compile this one in.  To prevent this function from being 
X * compiled, define "HAVE_GETOPT".  This is usually done in the "CFLAGS"
X * line of the corresponding machine module.
X */
X
X/*
X * This empty declaration exists solely to placate overexhuberant C
X * compilers that like to warn you about content-free files.
X */
Xstatic void __empty();
X
X#ifndef HAVE_GETOPT
X
X/*LINTLIBRARY*/
X
X#include "os.h"
X#ifndef NULL
X#define NULL	0
X#endif
X#ifndef EOF
X#define EOF	(-1)
X#endif
X#define ERR(s, c)	if(opterr){\
X	extern int write();\
X	char errbuf[2];\
X	errbuf[0] = c; errbuf[1] = '\n';\
X	(void) write(2, argv[0], strlen(argv[0]));\
X	(void) write(2, s, strlen(s));\
X	(void) write(2, errbuf, 2);}
X
X
Xint	opterr = 1;
Xint	optind = 1;
Xint	optopt;
Xchar	*optarg;
X
Xint
Xgetopt(argc, argv, opts)
Xint	argc;
Xchar	**argv, *opts;
X{
X	static int sp = 1;
X	register int c;
X	register char *cp;
X
X	if(sp == 1)
X		if(optind >= argc ||
X		   argv[optind][0] != '-' || argv[optind][1] == '\0')
X			return(EOF);
X		else if(strcmp(argv[optind], "--") == 0) {
X			optind++;
X			return(EOF);
X		}
X	optopt = c = argv[optind][sp];
X	if(c == ':' || (cp=strchr(opts, c)) == NULL) {
X		ERR(": unknown option, -", c);
X		if(argv[optind][++sp] == '\0') {
X			optind++;
X			sp = 1;
X		}
X		return('?');
X	}
X	if(*++cp == ':') {
X		if(argv[optind][sp+1] != '\0')
X			optarg = &argv[optind++][sp+1];
X		else if(++optind >= argc) {
X			ERR(": argument missing for -", c);
X			sp = 1;
X			return('?');
X		} else
X			optarg = argv[optind++];
X		sp = 1;
X	} else {
X		if(argv[optind][++sp] == '\0') {
X			sp = 1;
X			optind++;
X		}
X		optarg = NULL;
X	}
X	return(c);
X}
X#endif /* HAVE_GETOPT */
END_OF_FILE
if test 1872 -ne `wc -c <'top-3.4/getopt.c'`; then
    echo shar: \"'top-3.4/getopt.c'\" unpacked with wrong size!
fi
# end of 'top-3.4/getopt.c'
fi
if test -f 'top-3.4/install' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/install'\"
else
echo shar: Extracting \"'top-3.4/install'\" \(928 characters\)
sed "s/^X//" >'top-3.4/install' <<'END_OF_FILE'
X#!/bin/sh
X#
X# this shell script is amazingly similar to the old and lamented
X# BSD "install" command.  It recognized the following options:
X#
X#	-o target file owner
X#	-m target file mode
X#	-g target file group owner
X#
X#
X# scan the options
X#
Xwhile [ $# -gt 0 ]; do
X    case $1 in
X      -o)
X	owner=$2
X	shift ; shift
X	;;
X
X      -m)
X	mode=$2
X	shift; shift
X	;;
X
X      -g)
X	group=$2
X	shift ; shift
X	;;
X
X      -*)
X	echo "install: unknown option $1"
X	exit
X	;;
X
X      *)
X	break
X	;;
X    esac
Xdone
X#
X# we need two more:  filename and destination
X#
Xif [ $# -ne 2 ]; then
X    echo "Usage:  install [ -o owner ] [ -m mode ] [ -g group ] file destination"
X    exit
Xfi
X#
X# first, copy
X#
Xcp $1 $2
X#
X# normalize the name
X#
Xdest=$2
Xif [ -d $2 ]; then
X    dest=$2/`basename $1`
Xfi
X#
X# do optional things
X#
Xif [ "$owner" ]; then
X    chown $owner $dest
Xfi
Xif [ "$group" ]; then
X    chgrp $group $dest
Xfi
Xif [ "$mode" ]; then
X    chmod $mode $dest
Xfi
END_OF_FILE
if test 928 -ne `wc -c <'top-3.4/install'`; then
    echo shar: \"'top-3.4/install'\" unpacked with wrong size!
fi
chmod +x 'top-3.4/install'
# end of 'top-3.4/install'
fi
if test -f 'top-3.4/layout.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/layout.h'\"
else
echo shar: Extracting \"'top-3.4/layout.h'\" \(621 characters\)
sed "s/^X//" >'top-3.4/layout.h' <<'END_OF_FILE'
X/*
X *  Top - a top users display for Berkeley Unix
X *
X *  This file defines the locations on tne screen for various parts of the
X *  display.  These definitions are used by the routines in "display.c" for
X *  cursor addressing.
X */
X
X#define  x_lastpid	10
X#define  y_lastpid	0
X#define  x_loadave	33
X#define  x_loadave_nompid	15
X#define  y_loadave	0
X#define  x_procstate	0
X#define  y_procstate	1
X#define  x_brkdn	15
X#define  y_brkdn	1
X#define  x_mem		8
X#define  y_mem		3
X#define  y_message	4
X#define  x_header	0
X#define  y_header	5
X#define  x_idlecursor	0
X#define  y_idlecursor	4
X#define  y_procs	6
X
X#define  y_cpustates	2
END_OF_FILE
if test 621 -ne `wc -c <'top-3.4/layout.h'`; then
    echo shar: \"'top-3.4/layout.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/layout.h'
fi
if test -f 'top-3.4/loadavg.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/loadavg.h'\"
else
echo shar: Extracting \"'top-3.4/loadavg.h'\" \(1492 characters\)
sed "s/^X//" >'top-3.4/loadavg.h' <<'END_OF_FILE'
X/*
X *  Top - a top users display for Berkeley Unix
X *
X *  Defines required to access load average figures.
X *
X *  This include file sets up everything we need to access the load average
X *  values in the kernel in a machine independent way.  First, it sets the
X *  typedef "load_avg" to be either double or long (depending on what is
X *  needed), then it defines these macros appropriately:
X *
X *	loaddouble(la) - convert load_avg to double.
X *	intload(i)     - convert integer to load_avg.
X */
X
X/*
X * We assume that if FSCALE is defined, then avenrun and ccpu are type long.
X * If your machine is an exception (mips, perhaps?) then make adjustments
X * here.
X *
X * Defined types:  load_avg for load averages, pctcpu for cpu percentages.
X */
X#if defined(mips) && !defined(NetBSD)
X# include <sys/fixpoint.h>
X# if defined(FBITS) && !defined(FSCALE)
X#  define FSCALE (1 << FBITS)	/* mips */
X# endif
X#endif
X
X#ifdef FSCALE
X# define FIXED_LOADAVG FSCALE
X# define FIXED_PCTCPU FSCALE
X#endif
X
X#ifdef ibm032
X# undef FIXED_LOADAVG
X# undef FIXED_PCTCPU
X# define FIXED_PCTCPU PCT_SCALE
X#endif
X
X
X#ifdef FIXED_PCTCPU
X  typedef long pctcpu;
X# define pctdouble(p) ((double)(p) / FIXED_PCTCPU)
X#else
Xtypedef double pctcpu;
X# define pctdouble(p) (p)
X#endif
X
X#ifdef FIXED_LOADAVG
X  typedef long load_avg;
X# define loaddouble(la) ((double)(la) / FIXED_LOADAVG)
X# define intload(i) ((int)((i) * FIXED_LOADAVG))
X#else
X  typedef double load_avg;
X# define loaddouble(la) (la)
X# define intload(i) ((double)(i))
X#endif
END_OF_FILE
if test 1492 -ne `wc -c <'top-3.4/loadavg.h'`; then
    echo shar: \"'top-3.4/loadavg.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/loadavg.h'
fi
if test ! -d 'top-3.4/machine' ; then
    echo shar: Creating directory \"'top-3.4/machine'\"
    mkdir 'top-3.4/machine'
fi
if test -f 'top-3.4/machine.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine.h'\"
else
echo shar: Extracting \"'top-3.4/machine.h'\" \(1349 characters\)
sed "s/^X//" >'top-3.4/machine.h' <<'END_OF_FILE'
X/*
X *  This file defines the interface between top and the machine-dependent
X *  module.  It is NOT machine dependent and should not need to be changed
X *  for any specific machine.
X */
X
X/*
X * the statics struct is filled in by machine_init
X */
Xstruct statics
X{
X    char **procstate_names;
X    char **cpustate_names;
X    char **memory_names;
X#ifdef ORDER
X    char **order_names;
X#endif
X};
X
X/*
X * the system_info struct is filled in by a machine dependent routine.
X */
X
Xstruct system_info
X{
X    int    last_pid;
X    double load_avg[NUM_AVERAGES];
X    int    p_total;
X    int    p_active;     /* number of procs considered "active" */
X    int    *procstates;
X    int    *cpustates;
X    int    *memory;
X};
X
X/* cpu_states is an array of percentages * 10.  For example, 
X   the (integer) value 105 is 10.5% (or .105).
X */
X
X/*
X * the process_select struct tells get_process_info what processes we
X * are interested in seeing
X */
X
Xstruct process_select
X{
X    int idle;		/* show idle processes */
X    int system;		/* show system processes */
X    int uid;		/* only this uid (unless uid == -1) */
X    char *command;	/* only this command (unless == NULL) */
X};
X
X/* routines defined by the machine dependent module */
X
Xchar *format_header();
Xchar *format_next_process();
X
X/* non-int routines typically used by the machine dependent module */
Xchar *printable();
END_OF_FILE
if test 1349 -ne `wc -c <'top-3.4/machine.h'`; then
    echo shar: \"'top-3.4/machine.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine.h'
fi
if test -f 'top-3.4/machine/m_386bsd.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_386bsd.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_386bsd.man'\" \(194 characters\)
sed "s/^X//" >'top-3.4/machine/m_386bsd.man' <<'END_OF_FILE'
X.SH "386BSD NOTES"
XThe 386BSD port was adapted by Steve Hocking from a module 
Xoriginally written by Christos Zoulas.  The port was later updated
Xby Andrew Herbert (andrew@werple.apana.org.au).
END_OF_FILE
if test 194 -ne `wc -c <'top-3.4/machine/m_386bsd.man'`; then
    echo shar: \"'top-3.4/machine/m_386bsd.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_386bsd.man'
fi
if test -f 'top-3.4/machine/m_aix41.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_aix41.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_aix41.man'\" \(181 characters\)
sed "s/^X//" >'top-3.4/machine/m_aix41.man' <<'END_OF_FILE'
X.SH "AIX 4.1 NOTES"
XThe "last pid" is not displayed, as I couldn't figure out how to 
Xobtain it from the kernel.
X.LP
XThe AIX4.1 port was written by Joep Vesseur <joep@fwi.uva.nl>. 
END_OF_FILE
if test 181 -ne `wc -c <'top-3.4/machine/m_aix41.man'`; then
    echo shar: \"'top-3.4/machine/m_aix41.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_aix41.man'
fi
if test -f 'top-3.4/machine/m_aux3.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_aux3.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_aux3.man'\" \(567 characters\)
sed "s/^X//" >'top-3.4/machine/m_aux3.man' <<'END_OF_FILE'
X.SH "A/UX NOTES"
XThere is no obvious way to find the amount of memory per process
Xthat is currently resident.  The percent cpu usage is not
Xmaintained by the operating system, so we fake one.
XThe last pid number is not plucked from the operating system
Xeither.  The number given is based on the information collected
Xin the process snapshots.
X.LP
XAlthough AUX does not generally have a renice system call,
Xthere is a compile-time option that may have been enabled
Xwhen the program was installed.
X.LP
XThe A/UX 3.1 port was written by Richard Henderson <rth@tamu.edu>.
END_OF_FILE
if test 567 -ne `wc -c <'top-3.4/machine/m_aux3.man'`; then
    echo shar: \"'top-3.4/machine/m_aux3.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_aux3.man'
fi
if test -f 'top-3.4/machine/m_bsd44.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_bsd44.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_bsd44.man'\" \(138 characters\)
sed "s/^X//" >'top-3.4/machine/m_bsd44.man' <<'END_OF_FILE'
X.SH "4.4 BSD DIFFERENCES"
XThe 4.4 BSD port is said to work at least as well as ps does.
X
XThe 4.4 BSD port was written by Christos Zoulas.
END_OF_FILE
if test 138 -ne `wc -c <'top-3.4/machine/m_bsd44.man'`; then
    echo shar: \"'top-3.4/machine/m_bsd44.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_bsd44.man'
fi
if test -f 'top-3.4/machine/m_bsd44a.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_bsd44a.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_bsd44a.man'\" \(150 characters\)
sed "s/^X//" >'top-3.4/machine/m_bsd44a.man' <<'END_OF_FILE'
X.SH "4.4 BSD DIFFERENCES"
XThe 4.4 BSD alpha port is said to work at least as well as ps does.
X
XThe 4.4 BSD alpha port was written by Christos Zoulas.
END_OF_FILE
if test 150 -ne `wc -c <'top-3.4/machine/m_bsd44a.man'`; then
    echo shar: \"'top-3.4/machine/m_bsd44a.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_bsd44a.man'
fi
if test -f 'top-3.4/machine/m_bsdos2.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_bsdos2.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_bsdos2.man'\" \(202 characters\)
sed "s/^X//" >'top-3.4/machine/m_bsdos2.man' <<'END_OF_FILE'
X.SH "BSD/OS 2.X DIFFERENCES"
XThe BSD/OS port is said to work at least as well as ps does.
X
XThe BSD/OS 2.X port was done by Jeff Polk <polk@BSDI.COM>
Xbased on the 4.4BSD port written by Christos Zoulas.
END_OF_FILE
if test 202 -ne `wc -c <'top-3.4/machine/m_bsdos2.man'`; then
    echo shar: \"'top-3.4/machine/m_bsdos2.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_bsdos2.man'
fi
if test -f 'top-3.4/machine/m_convex.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_convex.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_convex.man'\" \(319 characters\)
sed "s/^X//" >'top-3.4/machine/m_convex.man' <<'END_OF_FILE'
X.SH "CONVEX DIFFERENCES"
XThe size field may be smaller then that of ps.  I believe the 
Xdifference is due to mmap memory.  
X
XThe Convex OS 11.X port was done by William L. Jones.  Most of it was
Xwas taken from the SunOS 4 port written by William LeFebvre.
XMinor formatting changes by Warren Vosper <warrenv@convex.com>
END_OF_FILE
if test 319 -ne `wc -c <'top-3.4/machine/m_convex.man'`; then
    echo shar: \"'top-3.4/machine/m_convex.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_convex.man'
fi
if test -f 'top-3.4/machine/m_dcosx.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_dcosx.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_dcosx.man'\" \(64 characters\)
sed "s/^X//" >'top-3.4/machine/m_dcosx.man' <<'END_OF_FILE'
X.SH "DC/OSX CREDITS"
XThe DC/OSX port was written by Phillip Wu.
END_OF_FILE
if test 64 -ne `wc -c <'top-3.4/machine/m_dcosx.man'`; then
    echo shar: \"'top-3.4/machine/m_dcosx.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_dcosx.man'
fi
if test -f 'top-3.4/machine/m_dgux.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_dgux.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_dgux.man'\" \(977 characters\)
sed "s/^X//" >'top-3.4/machine/m_dgux.man' <<'END_OF_FILE'
X.SH "DG/UX 5.4 DIFFERENCES"
XThe WCPU and SIZE columns are not shown, nor is the "last pid" display, as
Xthis information is not available from the kernel.
XA "processor utilization" column is added, with the heading C.  This number
Xreflects a process' relative interactivity, represented by an integer from
X0 to 7.  A process with 7 is highly interactive.  A process with 0 is not
Xconsidered interactive, but uses mostly CPU resources.
XThe "nice" processor time is not shown, but a "io_wait" processor state is
Xadded, represented the time spent waiting on I/O operations.  This is
Xcurrently always set to zero.
X
XProcess are considered "idle" unless they are in "run" or "wait" state.
XProcess are considered to be "system" processes if they have uid=0 and
Xppid=1.
XPercent CPU is not maintained by the kernel, and has to be calculated by
Xtop, by dividing the difference in system+user time by the delay period.
X
XThe DG/UX 5.4 port was written by Mike Williams <mike@inform.co.nz>.
END_OF_FILE
if test 977 -ne `wc -c <'top-3.4/machine/m_dgux.man'`; then
    echo shar: \"'top-3.4/machine/m_dgux.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_dgux.man'
fi
if test -f 'top-3.4/machine/m_dynix.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_dynix.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_dynix.man'\" \(319 characters\)
sed "s/^X//" >'top-3.4/machine/m_dynix.man' <<'END_OF_FILE'
X.SH "DYNIX DIFFERENCES"
XOne the Sequent DYNIX operating system, there is a distinction between runable
Xand running on a processor.  The STATE column reflects this by showing "run"
Xwhen the process is runable, and "RUN" when the process is actually running
Xon a processor.
X
XThe DYNIX port was written by Daniel Trinkle.
END_OF_FILE
if test 319 -ne `wc -c <'top-3.4/machine/m_dynix.man'`; then
    echo shar: \"'top-3.4/machine/m_dynix.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_dynix.man'
fi
if test -f 'top-3.4/machine/m_freebsd20.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_freebsd20.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_freebsd20.man'\" \(677 characters\)
sed "s/^X//" >'top-3.4/machine/m_freebsd20.man' <<'END_OF_FILE'
X.SH "FreeBSD 2.0 NOTES"
XLast pid is compiler depended. 
X
X$ strings /kernel | grep _nextpid
X
X.SH "DESCRIPTION OF MEMORY"
XMemory: 10M Act 1208K Inact 3220K Wired 132K Free 25% Swap, 2924Kin 2604Kout
X
X.TP
X.B K: 
XKilobyte
X.TP
X.B M: 
XMegabyte
X.TP
X.B %: 
X1/100
X
X.TP
X.B Act: 
Xnumber of pages active
X.TP
X.B Incat: 
Xnumber of pages inactive
X.TP
X.B Wired: 
Xnumber of pages wired down
X.TP
X.B Free: 
Xnumber of pages free
X
X.TP
X.B Swap: 
Xswap usage
X.TP 
X.B Kin: 
Xkilobytes swap pager pages paged in (last interval)
X.TP
X.B Kout: 
Xkilobytes swap pager pages paged out  (last interval)
X
X.PP
XSee /usr/include/sys/vmmeter.h and  /sys/vm/vm_meter.c.
X
X.PP
XWolfram Schneider <wosch@cs.tu-berlin.de>
END_OF_FILE
if test 677 -ne `wc -c <'top-3.4/machine/m_freebsd20.man'`; then
    echo shar: \"'top-3.4/machine/m_freebsd20.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_freebsd20.man'
fi
if test -f 'top-3.4/machine/m_ftx.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_ftx.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_ftx.man'\" \(301 characters\)
sed "s/^X//" >'top-3.4/machine/m_ftx.man' <<'END_OF_FILE'
X.SH "FTX CREDITS"
XThe SVR4 port was initially written by Andrew Herbert.  He was guided by a SVR4
Xport of top version 2.1 which was done by Andy Crump (andyc@bucky.intel.com).
XRobert Boucher (boucher@sofkin.ca) adapted it to top version 3.1.
XSteve Scherf further adapted the SVR4 port to Stratus FTX.
END_OF_FILE
if test 301 -ne `wc -c <'top-3.4/machine/m_ftx.man'`; then
    echo shar: \"'top-3.4/machine/m_ftx.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_ftx.man'
fi
if test -f 'top-3.4/machine/m_hpux9.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_hpux9.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_hpux9.man'\" \(463 characters\)
sed "s/^X//" >'top-3.4/machine/m_hpux9.man' <<'END_OF_FILE'
X.SH "HPUX 9 INFORMATION"
XUnder HP/UX 9, the kernel symbol _ccpu was eliminated.  The author
Xbelieve that _cexp is a suitable substitute, but cannot be positive.
XThis seems to be confirmed by the fact that information produced using
Xthis assumption correlates well with that produced by HP's version of top.
X
XThis port was adapted from the port for HP/UX version 8 (written by
XChristos Zoulas).  The adaptation was performed by Kevin Schmidt
X<kevin@mcl.ucsb.edu>.
END_OF_FILE
if test 463 -ne `wc -c <'top-3.4/machine/m_hpux9.man'`; then
    echo shar: \"'top-3.4/machine/m_hpux9.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_hpux9.man'
fi
if test -f 'top-3.4/machine/m_linux.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_linux.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_linux.man'\" \(221 characters\)
sed "s/^X//" >'top-3.4/machine/m_linux.man' <<'END_OF_FILE'
X.SH "LINUX NOTES"
XThe Linux port was written by Richard Henderson <rth@tamu.edu>.
XThe CPU% calculation was brazenly stolen from the Solaris 2
Xport and should be attributed to one of the many names listed
Xin its man page.
END_OF_FILE
if test 221 -ne `wc -c <'top-3.4/machine/m_linux.man'`; then
    echo shar: \"'top-3.4/machine/m_linux.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_linux.man'
fi
if test -f 'top-3.4/machine/m_ncr3000.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_ncr3000.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_ncr3000.man'\" \(345 characters\)
sed "s/^X//" >'top-3.4/machine/m_ncr3000.man' <<'END_OF_FILE'
X.SH "NCR System 3000 CREDITS"
XThe SVR4 port was initially written by Andrew Herbert.  He was guided by a SVR4
Xport of top version 2.1 which was done by Andy Crump (andyc@bucky.intel.com).
XRobert Boucher (boucher@sofkin.ca) adapted it to top version 3.1.
XJeff Janvrin (jeff.janvrin@columbiasc.ncr.com) ported version 3.3 to
Xthe /stats filesystem
END_OF_FILE
if test 345 -ne `wc -c <'top-3.4/machine/m_ncr3000.man'`; then
    echo shar: \"'top-3.4/machine/m_ncr3000.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_ncr3000.man'
fi
if test -f 'top-3.4/machine/m_netbsd08.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_netbsd08.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_netbsd08.man'\" \(129 characters\)
sed "s/^X//" >'top-3.4/machine/m_netbsd08.man' <<'END_OF_FILE'
X.SH "NetBSD NOTES"
X
XOnly tested with NetBSD/i386. Someone should check the memory size stuff.
XStolen back from the m_386bsd.c...
END_OF_FILE
if test 129 -ne `wc -c <'top-3.4/machine/m_netbsd08.man'`; then
    echo shar: \"'top-3.4/machine/m_netbsd08.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_netbsd08.man'
fi
if test -f 'top-3.4/machine/m_next40.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_next40.c'\"
else
echo shar: Extracting \"'top-3.4/machine/m_next40.c'\" \(1204 characters\)
sed "s/^X//" >'top-3.4/machine/m_next40.c' <<'END_OF_FILE'
X/*
X * top - a top users display for Unix
X * NEXTSTEP v.0.3  2/14/1996 tpugh
X *
X * SYNOPSIS:  any hppa or sparc NEXTSTEP v3.3 system
X *
X * DESCRIPTION:
X *	This is the machine-dependent module for NEXTSTEP v3.x/4.x
X *	Reported to work for:
X *		NEXTSTEP v3.2 on HP machines.
X *		NEXTSTEP v3.3 on HP and Sparc machines.
X * 	Has not been tested for NEXTSTEP v4.0 machines, although it should work.
X * 	Install "top" with the permissions 4755.
X *		tsunami# chmod 4755 top
X *		tsunami# ls -lg top
X *		-rwsr-xr-x  1 root     kmem      121408 Sep  1 10:14 top*
X *	With the kmem group sticky bit set, we can read kernal memory without problems,
X *	but to communicate with the Mach kernal for task and thread info, it requires
X *	root privileges.
X *
X * LIBS: 
X *
X * Need the compiler flag, "-DSHOW_UTT", to see the user task and thread task
X * data structures to report process info.
X * Need the compiler flag, "-DNEXTSTEP40", to use the proper task structure.
X * Need -I. for all the top include files which are searched for in machine/,
X * because of the way include "file" finds files.
X *
X * CFLAGS: -I. -DSHOW_UTT -DNEXTSTEP40
X *
X *
X * AUTHORS:		Tim Pugh <tpugh@oce.orst.edu>
X */
X
X#include "machine/m_next32.c"
END_OF_FILE
if test 1204 -ne `wc -c <'top-3.4/machine/m_next40.c'`; then
    echo shar: \"'top-3.4/machine/m_next40.c'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_next40.c'
fi
if test -f 'top-3.4/machine/m_next_task.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_next_task.h'\"
else
echo shar: Extracting \"'top-3.4/machine/m_next_task.h'\" \(3392 characters\)
sed "s/^X//" >'top-3.4/machine/m_next_task.h' <<'END_OF_FILE'
X/* 
X * This is a stripped-down and hacked version of task.h from NextStep 2.1
X * from the Informer.app by Max Tardiveau.
X *
X * tpugh 2/14/1996
X * I've modify this task structure to account some unknown variables in
X * NeXT's new (unpublished) task structure, so I can get to the utask structure.
X * tmp1[3] is in the right place, but tmp2[3] may not be in the right place.
X * So do not be surprised if any other variable in the structure, except utask,
X * is incorrectly aligned.
X *
X */
X
X
X#import <mach/boolean.h>
X#import <mach/port.h>
X#import <mach/time_value.h>
X#import <kernserv/lock.h>
X#import <kernserv/queue.h>
X#import <mach/mach_param.h>
X#import <mach/mach_types.h>
X
Xstruct task {
X#ifdef NEXTSTEP40
X	int tmp1[3];
X#endif
X	/* Synchronization/destruction information */
X	char lock[4];
X	int		ref_count;	/* Number of references to me */
X	boolean_t	active;		/* Task has not been terminated */
X
X	/* Miscellaneous */
X	char	map[4];		/* Address space description */
X	queue_chain_t	pset_tasks;	/* list of tasks assigned to pset */
X	int		suspend_count;	/* Internal scheduling only */
X
X	/* Thread information */
X	queue_head_t	thread_list;	/* list of threads */
X	int		thread_count;	/* number of threads */
X	char thread_list_lock[4]; /* XXX thread_list lock */
X	processor_set_t	processor_set;	/* processor set for new threads */
X#ifdef NEXTSTEP40
X	int tmp2[3];
X#endif
X	boolean_t	may_assign;	/* can assigned pset be changed? */
X	boolean_t	assign_active;	/* waiting for may_assign */
X
X	/* Garbage */
X	struct utask	*u_address;
X#if	NeXT
X	struct proc	*proc;		/* corresponding process */
X#else	NeXT
X	int		proc_index;	/* corresponding process, by index */
X#endif	NeXT
X
X	/* User-visible scheduling information */
X	int		user_stop_count;	/* outstanding stops */
X	int		priority;		/* for new threads */
X
X	/* Information for kernel-internal tasks */
X#if	NeXT
X	boolean_t	kernel_privilege; /* Is a kernel task */
X#endif	NeXT
X	boolean_t	kernel_ipc_space; /* Uses kernel's port names? */
X	boolean_t	kernel_vm_space; /* Uses kernel's pmap? */
X
X	/* Statistics */
X	time_value_t	total_user_time;
X				/* total user time for dead threads */
X	time_value_t	total_system_time;
X				/* total system time for dead threads */
X
X	/* Special ports */
X	port_t		task_self;	/* Port representing the task */
X	port_t		task_tself;	/* What the task thinks is task_self */
X	port_t		task_notify;	/* Where notifications get sent */
X	port_t		exception_port;	/* Where exceptions are sent */
X	port_t		bootstrap_port;	/* Port passed on for task startup */
X
X	/* IPC structures */
X	boolean_t	ipc_privilege;	/* Can use kernel resource pools? */
X	char ipc_translation_lock[4];
X	queue_head_t	ipc_translations; /* Per-task port naming */
X	boolean_t	ipc_active;	/* Can IPC rights be added? */
X	port_name_t	ipc_next_name;	/* Next local name to use */
X#if	MACH_IPC_XXXHACK
X	kern_set_t	ipc_enabled;	/* Port set for PORT_ENABLED */
X#endif	MACH_IPC_XXXHACK
X
X#if	MACH_IPC_TCACHE
X#define OBJ_CACHE_MAX		010	/* Number of cache lines */
X#define OBJ_CACHE_MASK		007	/* Mask for name->line */
X
X	struct {
X		port_name_t	name;
X		kern_obj_t	object;
X	}		obj_cache[OBJ_CACHE_MAX];
X					/* Fast object translation cache */
X#endif	MACH_IPC_TCACHE
X
X	/* IPC compatibility garbage */
X	boolean_t	ipc_intr_msg;	/* Send signal upon message arrival? */
X#define TASK_PORT_REGISTER_MAX 4 	/* Number of "registered" ports */
X	port_t		ipc_ports_registered[TASK_PORT_REGISTER_MAX];
X};
END_OF_FILE
if test 3392 -ne `wc -c <'top-3.4/machine/m_next_task.h'`; then
    echo shar: \"'top-3.4/machine/m_next_task.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_next_task.h'
fi
if test -f 'top-3.4/machine/m_sco.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_sco.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_sco.man'\" \(433 characters\)
sed "s/^X//" >'top-3.4/machine/m_sco.man' <<'END_OF_FILE'
X.SH "SCO UNIX NOTES"
XThe SCO Unix port was written by Gregory Shilin <shilin@onyx.co.il>.
XSCO Unix is almost totally different from normal Unix'es. Yes, there
Xis a variable avenrun in kernel, but its length is 8, so it cannot be
Xa 3 element array. And there is no variable cp_time at all. Also there
Xis no function setpriority() in SCO.  All attempts to set a process's
Xpriority (such as with the internal renice command) will fail.
END_OF_FILE
if test 433 -ne `wc -c <'top-3.4/machine/m_sco.man'`; then
    echo shar: \"'top-3.4/machine/m_sco.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_sco.man'
fi
if test -f 'top-3.4/machine/m_sunos4.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_sunos4.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_sunos4.man'\" \(1281 characters\)
sed "s/^X//" >'top-3.4/machine/m_sunos4.man' <<'END_OF_FILE'
X.SH "SUNOS 4 DIFFERENCES"
XOn multiprocessor machines, the amount of time the processors spend in
Xa spin lock is displayed along with the other processor state
Xpercentages.  The percentages shown for processor states are averages
Xacross all processors.  A process in run state also has its current
Xprocessor displayed in the STATE column, for example "run/2" indicates
Xrunning on processor 2.  There is an extra column in the process
Xdisplay indicating which processor each running process is assigned
Xto.  Information about physical memory is displayed on the memory
Xstatus line, but information about virtual memory is not available.
X
XDue to incompatabilities in kernel data structures, a top executable
Xcompiled on a Sun 4 multiprocessor architecture machine (sun4m) will
Xnot run correctly on a uniprocessor architecture machine (sun4), and
Xvice versa.  You will have to compile and maintain separate executables
Xfor these architectures.  Yeah, I don't like it either.
X
XSome processes may show up with a resident set size (RES column) larger
Xthan total virtual memory size (SIZE column).  This seems odd at first,
Xbut is a consequence of shared libraries:  shared memory is counted as
Xresident but is not counted in total size.
X
XThe SunOS 4 port was written by William LeFebvre.
END_OF_FILE
if test 1281 -ne `wc -c <'top-3.4/machine/m_sunos4.man'`; then
    echo shar: \"'top-3.4/machine/m_sunos4.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_sunos4.man'
fi
if test -f 'top-3.4/machine/m_sunos5.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_sunos5.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_sunos5.man'\" \(366 characters\)
sed "s/^X//" >'top-3.4/machine/m_sunos5.man' <<'END_OF_FILE'
X.SH "SUNOS 5 NOTES"
XThe SunOS 5 (Solaris 2) port was written by Torsten Kasch,
X<torsten@techfak.uni-bielefeld.de>.  Support for multi-cpu,
Xcalculation of CPU% and memory stats provided by
XRobert Boucher <boucher@sofkin.ca>, Marc Cohen <marc@aai.com>, 
XCharles Hedrick <hedrick@geneva.rutgers.edu>, 
XWilliam L. Jones <jones@chpc>, and Casper Dik <casper@fwi.uva.nl>.
END_OF_FILE
if test 366 -ne `wc -c <'top-3.4/machine/m_sunos5.man'`; then
    echo shar: \"'top-3.4/machine/m_sunos5.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_sunos5.man'
fi
if test -f 'top-3.4/machine/m_sunos54.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_sunos54.c'\"
else
echo shar: Extracting \"'top-3.4/machine/m_sunos54.c'\" \(1081 characters\)
sed "s/^X//" >'top-3.4/machine/m_sunos54.c' <<'END_OF_FILE'
X/*
X * top - a top users display for Unix
X *
X * SYNOPSIS:  Any Sun running SunOS 5.4 (Solaris 2.4) or later.
X *
X * DESCRIPTION:
X * This is the machine-dependent module for SunOS 5.4 and 5.5.
X * There is some support for MP architectures.
X * This makes top work on the following systems:
X *         SunOS 5.4
X *         SunOS 5.5
X *
X * Tested on a SS20/61 w/ SunPRO C 2.0.1 running Solaris 2.4/SPARC and
X * a P90 running Solaris 2.4/x86.
X *
X * LIBS: -lkvm -lelf -lkstat
X *
X * Need -I. for all the top include files which are searched for in machine/,
X * because of the way include "file" finds files.
X *
X * CFLAGS: -I. -DHAVE_GETOPT -DORDER -DSOLARIS24
X *
X * AUTHORS:      Torsten Kasch 		<torsten@techfak.uni-bielefeld.de>
X *               Robert Boucher		<boucher@sofkin.ca>
X * CONTRIBUTORS: Marc Cohen 		<marc@aai.com>
X *               Charles Hedrick 	<hedrick@geneva.rutgers.edu>
X *	         William L. Jones 	<jones@chpc>
X *               Petri Kutvonen         <kutvonen@cs.helsinki.fi>
X *	         Casper Dik             <casper@fwi.uva.nl>
X */
X#include "machine/m_sunos5.c"
END_OF_FILE
if test 1081 -ne `wc -c <'top-3.4/machine/m_sunos54.c'`; then
    echo shar: \"'top-3.4/machine/m_sunos54.c'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_sunos54.c'
fi
if test -f 'top-3.4/machine/m_svr4.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_svr4.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_svr4.man'\" \(328 characters\)
sed "s/^X//" >'top-3.4/machine/m_svr4.man' <<'END_OF_FILE'
X.SH "SVR4 CREDITS"
XThe SVR4 port was initially written by Andrew Herbert.  He was guided by a SVR4
Xport of top version 2.1 which was done by Andy Crump (andyc@bucky.intel.com).
XRobert Boucher (boucher@sofkin.ca) adapted it to top version 3.1.
XPorted to System 3000 Release 2.03 by 
XJeff Janvrin (jeff.janvrinColumbiaSC.NCR.COM)
END_OF_FILE
if test 328 -ne `wc -c <'top-3.4/machine/m_svr4.man'`; then
    echo shar: \"'top-3.4/machine/m_svr4.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_svr4.man'
fi
if test -f 'top-3.4/machine/m_svr42.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_svr42.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_svr42.man'\" \(118 characters\)
sed "s/^X//" >'top-3.4/machine/m_svr42.man' <<'END_OF_FILE'
X.SH "SVR42 CREDITS"
XThe SVR42 port was hacked by David Cutter from the SVR4 port initially
Xwritten by Andrew Herbert.
END_OF_FILE
if test 118 -ne `wc -c <'top-3.4/machine/m_svr42.man'`; then
    echo shar: \"'top-3.4/machine/m_svr42.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_svr42.man'
fi
if test -f 'top-3.4/machine/m_umax.man' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/machine/m_umax.man'\"
else
echo shar: Extracting \"'top-3.4/machine/m_umax.man'\" \(1024 characters\)
sed "s/^X//" >'top-3.4/machine/m_umax.man' <<'END_OF_FILE'
X.SH "MULTIMAX DIFFERENCES"
XThe umax operating system does not assign process ids sequentially, so
Xthere is no "last pid" display.  Process state names are: run, exec,
Xwait, event, start, stop.  Information about physical memory is
Xdisplayed on the memory status line, but information about virtual
Xmemory is not available.  WCPU is not displayed.  Percent CPU is
Xcalculated ove the entire life of the process and is a measure of the
Xpercentage of the process's life time spent running.  This is very
Xdifferent from the typical Unix measure of percent cpu, but is the
Xbest that can be done with the information available.  Also, no
Xattempt is made to determine if a process is currently "idle", thus
Xthe -I flag is assumed to always be true (idle processes are displayed).
X
XThe multimax port is not thorough and not complete.  It was done more
Xas an exercise in porting top than as an effort to create something
Xuseful.  Currently cpu state percentages are not calculated.
X
XThe Multimax port was written by William LeFebvre.
END_OF_FILE
if test 1024 -ne `wc -c <'top-3.4/machine/m_umax.man'`; then
    echo shar: \"'top-3.4/machine/m_umax.man'\" unpacked with wrong size!
fi
# end of 'top-3.4/machine/m_umax.man'
fi
if test -f 'top-3.4/metatop' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/metatop'\"
else
echo shar: Extracting \"'top-3.4/metatop'\" \(1331 characters\)
sed "s/^X//" >'top-3.4/metatop' <<'END_OF_FILE'
X#! /bin/sh
X#
X# Top is very sensitive to differences in the kernel, so much so that an
X# executable created on one sub-architecture may not work on others.  It
X# is also quite common for a minor OS revision to require recompilation of
X# top.  Both of these problems are especially prevalent on Suns.  For
X# example, a top executable made under SunOS 4.1.1 will not run correctly
X# under SunOS 4.1.2, and vice versa.  "metatop" attempts to solve this
X# problem by choosing one of several possible top executables to run then
X# executing it.
X#
X# To use metatop your operating system needs to have the command "uname"
X# as part of the standard OS release.  MAKE SURE IT DOES before proceeding.
X# It will try to execute the command "top-`uname -m`-`uname -r`"  For 
X# example, on a sparcstation 1 running SunOS 4.1.1, it will try to run
X# "top-sun4c-4.1.1".
X#
X# INSTALLATION is easy.  Just compile top as normal.  Then use the command
X# "make metainstall" (on the same machine!) instead of the usual.  "make"
X# will insure that this shell script is installed correctly then will install
X# the most recently made top executable with the correct name.  Remember:
X# you will need to "make clean" and "make metainstall" on every different
X# combination of sub-architecture and OS version that you have.
X#
Xexec $0-`uname -m`-`uname -r` "$@"
END_OF_FILE
if test 1331 -ne `wc -c <'top-3.4/metatop'`; then
    echo shar: \"'top-3.4/metatop'\" unpacked with wrong size!
fi
chmod +x 'top-3.4/metatop'
# end of 'top-3.4/metatop'
fi
if test -f 'top-3.4/os.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/os.h'\"
else
echo shar: Extracting \"'top-3.4/os.h'\" \(780 characters\)
sed "s/^X//" >'top-3.4/os.h' <<'END_OF_FILE'
X#include <sys/types.h>
X#include <sys/param.h>	/* This defines BSD */
X#if defined(BSD) && !defined(BSD4_4) && !defined(__osf__)
X# include <stdio.h>
X# include <strings.h>
X# define strchr(a, b)		index((a), (b))
X# define strrchr(a, b)		rindex((a), (b))
X# define memcpy(a, b, c)	bcopy((b), (a), (c))
X# define memzero(a, b)		bzero((a), (b))
X# define memcmp(a, b, c)	bcmp((a), (b), (c))
X#if defined(NeXT)
X  typedef void sigret_t;
X#else
X  typedef int sigret_t;
X#endif
X
X/* system routines that don't return int */
Xchar *getenv();
Xcaddr_t malloc();
X
X#else 
X# include <stdio.h>
X# define setbuffer(f, b, s)	setvbuf((f), (b), (b) ? _IOFBF : _IONBF, (s))
X# include <string.h>
X# include <memory.h>
X# include <stdlib.h>
X# define memzero(a, b)		memset((a), 0, (b))
X  typedef void sigret_t;
X#endif
END_OF_FILE
if test 780 -ne `wc -c <'top-3.4/os.h'`; then
    echo shar: \"'top-3.4/os.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/os.h'
fi
if test -f 'top-3.4/patchlevel.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/patchlevel.h'\"
else
echo shar: Extracting \"'top-3.4/patchlevel.h'\" \(21 characters\)
sed "s/^X//" >'top-3.4/patchlevel.h' <<'END_OF_FILE'
X#define PATCHLEVEL 4
END_OF_FILE
if test 21 -ne `wc -c <'top-3.4/patchlevel.h'`; then
    echo shar: \"'top-3.4/patchlevel.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/patchlevel.h'
fi
if test -f 'top-3.4/prime.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/prime.c'\"
else
echo shar: Extracting \"'top-3.4/prime.c'\" \(458 characters\)
sed "s/^X//" >'top-3.4/prime.c' <<'END_OF_FILE'
X/*
X * Prime number generator.  It prints on stdout the next prime number
X * higher than the number specified as argv[1].
X */
X
X#include <math.h>
X
Xmain(argc, argv)
X
Xint argc;
Xchar *argv[];
X
X{
X    double i, j;
X    int f;
X
X    if (argc < 2)
X    {
X	exit(1);
X    }
X
X    i = atoi(argv[1]);
X    while (i++)
X    {
X	f=1;
X	for (j=2; j<i; j++)
X	{
X	    if ((i/j)==floor(i/j))
X	    {
X		f=0;
X		break;
X	    }
X	}
X	if (f)
X	{
X	    printf("%.0f\n", i);
X	    exit(0);
X	}
X    }
X}
END_OF_FILE
if test 458 -ne `wc -c <'top-3.4/prime.c'`; then
    echo shar: \"'top-3.4/prime.c'\" unpacked with wrong size!
fi
# end of 'top-3.4/prime.c'
fi
if test -f 'top-3.4/screen.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/screen.h'\"
else
echo shar: Extracting \"'top-3.4/screen.h'\" \(991 characters\)
sed "s/^X//" >'top-3.4/screen.h' <<'END_OF_FILE'
X/*
X *  top - a top users display for Unix 4.2
X *
X *  This file contains all the definitions necessary to use the hand-written
X *  screen package in "screen.c"
X */
X
X#define TCputs(str)	tputs(str, 1, putstdout)
X#define putcap(str)	(void)((str) != NULL ? TCputs(str) : 0)
X#define Move_to(x, y)	TCputs(tgoto(cursor_motion, x, y))
X
X/* declare return values for termcap functions */
Xchar *tgetstr();
Xchar *tgoto();
X
Xextern char ch_erase;		/* set to the user's erase character */
Xextern char ch_kill;		/* set to the user's kill  character */
Xextern char smart_terminal;     /* set if the terminal has sufficient termcap
X				   capabilities for normal operation */
X
X/* These are some termcap strings for use outside of "screen.c" */
Xextern char *cursor_motion;
Xextern char *clear_line;
Xextern char *clear_to_end;
X
X/* rows and columns on the screen according to termcap */
Xextern int  screen_length;
Xextern int  screen_width;
X
X/* a function that puts a single character on stdout */
Xint putstdout();
END_OF_FILE
if test 991 -ne `wc -c <'top-3.4/screen.h'`; then
    echo shar: \"'top-3.4/screen.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/screen.h'
fi
if test -f 'top-3.4/sigconv.awk' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/sigconv.awk'\"
else
echo shar: Extracting \"'top-3.4/sigconv.awk'\" \(1098 characters\)
sed "s/^X//" >'top-3.4/sigconv.awk' <<'END_OF_FILE'
XBEGIN		{
X		    nsig = 0;
X		    j = 0;
X		    print "/* This file was automatically generated */"
X		    print "/* by the awk script \"sigconv.awk\".      */\n"
X		    print "struct sigdesc {"
X		    print "    char *name;"
X		    print "    int  number;"
X		    print "};\n"
X		    print "struct sigdesc sigdesc[] = {"
X		}
X
X/^#define[ \t][ \t]*SIG[A-Z]/	{
X
X				    j = sprintf("%d", $3);
X				    str = $2;
X
X				    if (nsig < j) 
X					nsig = j;
X
X				    siglist[j] = sprintf("\"%s\",\t%2d,", \
X						substr(str, 4), j);
X				}
X/^#[ \t]*define[ \t][ \t]*SIG[A-Z]/	{
X
X				    j = sprintf("%d", $4);
X				    str = $3;
X
X				    if (nsig < j)
X					nsig = j;
X
X				    siglist[j] = sprintf("\"%s\",\t%2d,", \
X						substr(str, 4), j);
X				}
X/^#[ \t]*define[ \t][ \t]*_SIG[A-Z]/	{
X
X				    j = sprintf("%d", $4);
X				    str = $3;
X
X				    if (nsig < j)
X					nsig = j;
X
X				    siglist[j] = sprintf("\"%s\",\t%2d,", \
X					    substr(str, 5), j);
X				}
X
XEND				{
X				    for (n = 1; n <= nsig; n++) 
X					if (siglist[n] != "")
X					    printf("    %s\n", siglist[n]);
X
X				    printf("    NULL,\t 0\n};\n");
X				}
END_OF_FILE
if test 1098 -ne `wc -c <'top-3.4/sigconv.awk'`; then
    echo shar: \"'top-3.4/sigconv.awk'\" unpacked with wrong size!
fi
# end of 'top-3.4/sigconv.awk'
fi
if test -f 'top-3.4/top.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/top.h'\"
else
echo shar: Extracting \"'top-3.4/top.h'\" \(721 characters\)
sed "s/^X//" >'top-3.4/top.h' <<'END_OF_FILE'
X/*
X *  Top - a top users display for Berkeley Unix
X *
X *  General (global) definitions
X */
X
X/* Current major version number */
X#define VERSION		3
X
X/* Number of lines of header information on the standard screen */
X#define Header_lines	6
X
X/* Maximum number of columns allowed for display */
X#define MAX_COLS	128
X
X/* Log base 2 of 1024 is 10 (2^10 == 1024) */
X#define LOG1024		10
X
Xchar *itoa();
Xchar *itoa7();
X
Xchar *version_string();
X
X/* Special atoi routine returns either a non-negative number or one of: */
X#define Infinity	-1
X#define Invalid		-2
X
X/* maximum number we can have */
X#define Largest		0x7fffffff
X
X/*
X * The entire display is based on these next numbers being defined as is.
X */
X
X#define NUM_AVERAGES    3
X
END_OF_FILE
if test 721 -ne `wc -c <'top-3.4/top.h'`; then
    echo shar: \"'top-3.4/top.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/top.h'
fi
if test -f 'top-3.4/top.local.H' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/top.local.H'\"
else
echo shar: Extracting \"'top-3.4/top.local.H'\" \(2458 characters\)
sed "s/^X//" >'top-3.4/top.local.H' <<'END_OF_FILE'
X/*
X *  Top - a top users display for Berkeley Unix
X *
X *  Definitions for things that might vary between installations.
X */
X
X/*
X *  The space command forces an immediate update.  Sometimes, on loaded
X *  systems, this update will take a significant period of time (because all
X *  the output is buffered).  So, if the short-term load average is above
X *  "LoadMax", then top will put the cursor home immediately after the space
X *  is pressed before the next update is attempted.  This serves as a visual
X *  acknowledgement of the command.  On Suns, "LoadMax" will get multiplied by
X *  "FSCALE" before being compared to avenrun[0].  Therefore, "LoadMax"
X *  should always be specified as a floating point number.
X */
X#ifndef LoadMax
X#define LoadMax  %LoadMax%
X#endif
X
X/*
X *  "Table_size" defines the size of the hash tables used to map uid to
X *  username.  The number of users in /etc/passwd CANNOT be greater than
X *  this number.  If the error message "table overflow: too many users"
X *  is printed by top, then "Table_size" needs to be increased.  Things will
X *  work best if the number is a prime number that is about twice the number
X *  of lines in /etc/passwd.
X */
X#ifndef Table_size
X#define Table_size	%TableSize%
X#endif
X
X/*
X *  "Nominal_TOPN" is used as the default TOPN when Default_TOPN is Infinity
X *  and the output is a dumb terminal.  If we didn't do this, then
X *  installations who use a default TOPN of Infinity will get every
X *  process in the system when running top on a dumb terminal (or redirected
X *  to a file).  Note that Nominal_TOPN is a default:  it can still be
X *  overridden on the command line, even with the value "infinity".
X */
X#ifndef Nominal_TOPN
X#define Nominal_TOPN	%NominalTopn%
X#endif
X
X#ifndef Default_TOPN
X#define Default_TOPN	%topn%
X#endif
X
X#ifndef Default_DELAY
X#define Default_DELAY	%delay%
X#endif
X
X/*
X *  If the local system's getpwnam interface uses random access to retrieve
X *  a record (i.e.: 4.3 systems, Sun "yellow pages"), then defining
X *  RANDOM_PW will take advantage of that fact.  If RANDOM_PW is defined,
X *  then getpwnam is used and the result is cached.  If not, then getpwent
X *  is used to read and cache the password entries sequentially until the
X *  desired one is found.
X *
X *  We initially set RANDOM_PW to something which is controllable by the
X *  Configure script.  Then if its value is 0, we undef it.
X */
X
X#define RANDOM_PW	%random%
X#if RANDOM_PW == 0
X#undef RANDOM_PW
X#endif
END_OF_FILE
if test 2458 -ne `wc -c <'top-3.4/top.local.H'`; then
    echo shar: \"'top-3.4/top.local.H'\" unpacked with wrong size!
fi
# end of 'top-3.4/top.local.H'
fi
if test -f 'top-3.4/utils.h' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/utils.h'\"
else
echo shar: Extracting \"'top-3.4/utils.h'\" \(522 characters\)
sed "s/^X//" >'top-3.4/utils.h' <<'END_OF_FILE'
X/*
X *  Top users/processes display for Unix
X *  Version 3
X *
X *  This program may be freely redistributed,
X *  but this entire comment MUST remain intact.
X *
X *  Copyright (c) 1984, 1989, William LeFebvre, Rice University
X *  Copyright (c) 1989, 1990, 1992, William LeFebvre, Northwestern University
X */
X
X/* prototypes for functions found in utils.c */
X
Xint atoiwi();
Xchar *itoa();
Xchar *itoa7();
Xint digits();
Xchar *strecpy();
Xchar **argparse();
Xlong percentages();
Xchar *errmsg();
Xchar *format_time();
Xchar *format_k();
END_OF_FILE
if test 522 -ne `wc -c <'top-3.4/utils.h'`; then
    echo shar: \"'top-3.4/utils.h'\" unpacked with wrong size!
fi
# end of 'top-3.4/utils.h'
fi
if test -f 'top-3.4/version.c' -a "${1}" != "-c" ; then 
  echo shar: Will not clobber existing file \"'top-3.4/version.c'\"
else
echo shar: Extracting \"'top-3.4/version.c'\" \(520 characters\)
sed "s/^X//" >'top-3.4/version.c' <<'END_OF_FILE'
X/*
X *  Top users/processes display for Unix
X *  Version 3
X *
X *  This program may be freely redistributed,
X *  but this entire comment MUST remain intact.
X *
X *  Copyright (c) 1984, 1989, William LeFebvre, Rice University
X *  Copyright (c) 1989, 1990, 1992, William LeFebvre, Northwestern University
X */
X
X#include "top.h"
X#include "patchlevel.h"
X
Xstatic char version[16];
X
Xchar *version_string()
X
X{
X    sprintf(version, "%d.%d", VERSION, PATCHLEVEL);
X#ifdef BETA
X    strcat(version, BETA);
X#endif
X    return(version);
X}
END_OF_FILE
if test 520 -ne `wc -c <'top-3.4/version.c'`; then
    echo shar: \"'top-3.4/version.c'\" unpacked with wrong size!
fi
# end of 'top-3.4/version.c'
fi
echo shar: End of archive 1 \(of 22\).
cp /dev/null ark1isdone
MISSING=""
for I in 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 ; do
    if test ! -f ark${I}isdone ; then
	MISSING="${MISSING} ${I}"
    fi
done
if test "${MISSING}" = "" ; then
    echo You have unpacked all 22 archives.
    echo "Now read README and INSTALL, then run Configure"
    rm -f ark[1-9]isdone ark[1-9][0-9]isdone
else
    echo You still need to unpack the following archives:
    echo "        " ${MISSING}
fi
##  End of shell archive.
exit 0

