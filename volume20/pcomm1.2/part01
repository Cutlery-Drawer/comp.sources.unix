Subject:  v20i067:  Pcomm telecommunication package, Part01/08
Newsgroups: comp.sources.unix
Sender: sources
Approved: rsalz@uunet.UU.NET

Submitted-by: uiucuxc!fthood!egray
Posting-number: Volume 20, Issue 67
Archive-name: pcomm1.2/part01

[  Only a formatted reference manual... /r$ ]

This is the Pcomm version 1.2 distribution package.  Pcomm is a public
domain telecommunication program for Unix designed to operate similar to
the popular MSDOS program, ProComm.  ProComm (TM) is copyrighted by
Datastorm Technologies Inc.

Some of the new features in v1.2 are:
	1) Support for Berkeley flavors of Unix.  (I'll admit that the
	   Berkeley port could use some more testing).
	2) Auto-login scripts (using Unix shell scripts).
	3) External file transfer programs can have their names imbedded
	   into the list of available protocols.
	4) Faster operation through tunable I/O buffering.

The distribution package is quite large... (about 450k total) and is
broken into 8 parts for easier mailing.

There is a shell archive called "Unixpc.shar" that contains the files
specific to the AT&T Unix PC 7300/3b1.

Here is a complete manifest of the distribution package:

Doc            curses.c       getopt.c       passthru.c     terminal.c
Makefile       d_delete.c     help.c         pexit.c        tty_att.c
Matches.1      d_lib.c        info.c         port.c         tty_ucb.c
Modem_break.1  d_manual.c     init.c         redial.c       vcs.c
Pcomm.1        d_menu.c       input.c        s_axfer.c      vcs.h
Pcomm.dial_dir d_print.c      list_dir.c     s_extrnl.c     waitfor.c
Pcomm.extrnl   d_prompt.c     ls_menu.c      s_gen.c        x_ascii.c
Pcomm.modem    d_revise.c     m_lib.c        s_menu.c       x_batch.c
Pcomm.param    data_log.c     macro.c        s_modem.c      x_extrnl.c
Readme         di_delay.c     main.c         s_prompt.c     x_menu.c
Release.notes  di_win.c       matches.c      s_term.c       x_rcv.c
Sample         dial.c         misc.h         s_tty.c        x_send.c
Unixpc.shar    dial_dir.h     modem.h        screen.c       x_win.c
Waitfor.1      e_lib.c        modem_break.c  script.c       xmodem.c
admin.c        expand.c       n_shell.c      st_line.c      xmodem.h
chg_dir.c      extrnl.h       p_lib.c        status.h
config.h       getcwd.c       param.h        strings.c

By the way, I intend to post bug fixes to comp.sources.bugs.

Have fun...

Emmet P. Gray				US Army, HQ III Corps & Fort Hood
...!uunet!uiucuxc!fthood!egray		Attn: AFZF-DE-ENV
					Directorate of Engineering & Housing
					Environmental Management Office
					Fort Hood, TX 76544-5057

------------------------------------------------------------------------------
#! /bin/sh
# This is a shell archive, meaning:
# 1. Remove everything above the #! /bin/sh line.
# 2. Save the resulting text in a file.
# 3. Execute the file with /bin/sh (not csh) to create:
#	Doc
export PATH; PATH=/bin:/usr/bin:$PATH
echo shar: "extracting 'Doc'" '(61114 characters)'
if test -f 'Doc'
then
	echo shar: "will not over-write existing file 'Doc'"
else
sed 's/^X//' << \SHAR_EOF > 'Doc'
X
X
X
X
X
X
X
X
X
X
X		  PPPPPP    CCCC    OOOO    MM   MM   MM   MM
X		  P    P   C       O    O   M M M M   M M M M
X		  PPPPPP   C       O    O   M  M  M   M  M  M
X		  P        C       O    O   M     M   M     M
X		  P         CCCC    OOOO    M     M   M     M
X
X
X
X
X
X
X
X
X			    Pcomm Reference Manual
X
X				  version 1.2
X
X
X
X
X				  written by
X
X				 Emmet P. Gray
X			...!uunet!uiucuxc!fthood!egray
X
X
X
X
X
X
X	Pcomm is a public domain telecommunication program for Unix that
X	is  designed  to  operate similar to the MSDOS program, ProComm.
X	ProComm (TM) is  copyrighted  by  Datastorm  Technologies,  Inc.
X	This  is a completely new program and contains no ProComm source
X	code.  This is not a Datastorm product.
X
X
X
X			       Table of Contents
X
X
X
X
X	1. INTRODUCTION .......... 3       5. UTILITY FUNCTIONS ..... 20
X	1.1 Abbreviations ........ 3       5.1 Program information .. 20
X	1.2 Requirements ......... 3       5.2 Setup screen ......... 20
X	1.3 Support files ........ 4       5.3 Change directory ..... 20
X					   5.4 Clear screen ......... 20
X	2. RUNNING PCOMM ......... 5       5.5 Toggle duplex ........ 20
X	2.1 Hot key .............. 5       5.6 Hang up the phone .... 20
X	2.2 Status line .......... 5       5.7 Printer logging ...... 21
X	2.3 Help screen .......... 6       5.8 Toggle CR - CR/LF .... 21
X	2.4 Exit Pcomm ........... 6       5.9 Break ................ 21
X
X	3. SETUP SCREENS ......... 7	   6. FILE FUNCTIONS ........ 22
X	3.1 Prompting ............ 7       6.1 External protocols ... 22
X	3.2 TTY setup ............ 8       6.2 Send files ........... 22
X	3.3 Modem setup........... 9       6.3 Receive files ........ 24
X	3.4 Terminal setup ....... 10      6.4 Pass thru mode ....... 24
X	3.5 General setup ........ 11      6.5 Directory ............ 25
X	3.6 ASCII transfer setup . 12      6.6 Screen dump .......... 25
X	3.7 External protocol .... 14      6.7 Start data logging ... 25
X					   6.8 Toggle logging ....... 26
X	4. MAJOR FUNCTIONS ....... 15
X	4.1 Dialing dierctory .... 15      7. DIALING WINDOW ........ 27
X	4.2 Redial ............... 17
X	4.3 Keyboard macros ...... 17      8. AUTO-LOGIN SCRIPTS .... 28
X	4.4 Line settings ........ 18      8.1 Waitfor Command ...... 28
X	4.5 Exit Pcomm ........... 19      8.2 Matches Command ...... 29
X	4.6 Unix gateway ......... 19      8.3 Modem_break Command .. 29
X					   8.4 Examples ............. 30
X
X
X
X
X
X
X	      Appendix A - Typical Modem Configuration ...... 31
X	      Appendix B - AT&T Unix PC 7300/3b1 Dial Codes . 32
X	      Appendix C - Using Telebit Trailblazers ....... 34
X
X	1. INTRODUCTION
X
X	Pcomm is a public domain, menu driven, telecommunication program
X	designed  to  provide the same "ease of use" as similar programs
X	available in MSDOS.  Some of its features are:
X
X		+o Large dialing directory
X		+o Auto-login shell scripts
X		+o Automatic redial feature
X		+o Supports popular file transfer protocols
X		+o External file transfer program support
X		+o Data logging (log of the terminal session)
X		+o Printer logging
X		+o Screen dump
X		+o Shell escapes
X		+o Help screen
X		+o Keyboard macros
X		+o User customization
X		+o Administrative logging of phone calls
X		+o Administrative limits on long distance access
X
X	Pcomm  does  not  emulate  any  particular  terminal.   Whatever
X	terminal you're on, is what the remote system "sees".
X
X	1.1 Abbreviations
X
X	Pcomm uses the notation "^A-X" to mean control-A followed by the
X	letter  X.  The dash (-) in the notation is just for clarity; it
X	is not included in the actual command sequence.  Also, there  is
X	no distinction between upper and lower case letters.
X
X	The following abbreviations appear in Pcomm:
X
X		<CR>	carriage return key (sometimes labeled "Enter")
X		<ESC>	escape key
X		<SPACE>	space bar
X		<DEL>	del key
X		<up>	up arrow key
X		<down>	down arrow key
X		LF	line feed character (control-J)
X		CR	carriage return character (control-M)
X
X	1.2 Requirements
X
X	Pcomm will not run on terminals with a screen size of less  than
X	80 columns by 24 lines or on terminals that lack cursor movement
X	capabilities.  For terminals without arrow keys, use the  letter
X	"U"  in place of "up arrow" and the letter "N" in place of "down
X	arrow" (the letter "D" would have been a  more  obvious  choice,
X	but, unfortunately, it is used elsewhere).
X
X	1.3 Support files
X
X	Pcomm uses four support files, namely:
X
X		pcomm.dial_dir	the dialing directory
X		pcomm.extrnl	the external file transfer programs
X		pcomm.modem	the modem/TTY database
X		pcomm.param	the start-up default parameters
X
X	There is a default directory (typically  "/usr/local/lib/pcomm")
X	where the "standard" support files live.  Since the average user
X	won't have write permission on these files,  it's  assumed  that
X	they  will copy one or more of these standard files to their own
X	directories and edit them to suit their needs.
X
X	Pcomm can use the environmental variable "PCOMM" to  search  for
X	these  "private"  support  files.   If  used,  the variable must
X	contain the path to the directory containing the files.  You can
X	"mix  and  match" the use of standard and private support files.
X	For example, the pcomm.modem file is rarely changed by the  user
X	so  there  would  be  no  need  to copy that file to the private
X	directory.
X
X	Pcomm also uses normal Unix shell scripts to perform the  "chat"
X	sequences necessary to automatically log a user onto a system.
X
X	The following directories  are  searched  to  find  the  support
X	files and the auto-login shell scripts:
X
X		+o directory given with the "-d" option
X		+o directory in the PCOMM environmental variable
X		+o the current working directory
X		+o the default directory (compiled into Pcomm)
X
X	2. RUNNING PCOMM
X
X	Pcomm has the following command line syntax.
X
X		pcomm [-d directory] [-f system name]
X
X	The "-d" option allows you to specify an additional path  to  be
X	used when searching for the Pcomm support files.  This option is
X	often useful for "borrowing" someone else's dialing directory.
X
X	The "-f" option is used to specify automatic dialing of an entry
X	in  the  dialing  directory.   The  "name"  field in the dialing
X	directory (described later) is checked against the string  given
X	on  the  command  line.   If  a  match  is  found, that entry is
X	automatically dialed.  The match does  not  consider  upper  and
X	lower case differences.
X
X	2.1 Hot key
X
X	Pcomm uses a "hot key" to precede each command.  (The  value  of
X	the  hot key is a user tunable parameter, but for the purpose of
X	this document we'll assume the hot key is defined as control-A).
X
X	The hot key is used to put  Pcomm  in  the  command  mode.   For
X	example,  to  get the help screen, you type control-A (to get to
X	the command mode)  then  the  number  0  (to  display  the  help
X	screen).   When  a  command  is  completed, Pcomm returns to the
X	terminal mode.
X
X	NOTE:  While in the command mode,  the  communication  with  the
X	remote system is temporarily suspended.
X
X	2.2 Status line
X
X	Whenever Pcomm is in the  command  mode  (or  is  not  currently
X	connected  to a remote) a status line is displayed at the bottom
X	of the screen.  A typical status line might look like this:
X
X    +----------------------------------------------------------------------+
X    | ^A-0 HELP  | No TTY | FDX | 1200 E71 | LOG OFF | PTR OFF | CR  | CR  |
X    +----------------------------------------------------------------------+
X
X	The eight fields of the status line are:
X
X		+o help screen command (or a temporary message)
X		+o name of the TTY device in use
X		+o duplex mode (FDX = full duplex, HDX = half duplex)
X		+o current line settings
X		+o status of data logging option
X		+o status of printer logging option
X		+o incoming CR translation
X		+o outgoing CR translation
X
X	2.3 Help screen
X
X	The help screen gives  a  brief  review  of  all  the  available
X	commands.   To  access  the  help screen type ^A and "0" (zero).
X	The typical help screen will look like this:
X
X  +---------------------------------------------------------------------------+
X  |                           P C O M M     H E L P                           |
X  |---------------------------------------------------------------------------|
X  |                                                                           |
X  |      Major Functions        Utility Functions        File Functions       |
X  |                                                                           |
X  | Dialing Directory. ^A-D  Program Info .... ^A-I  Send Files .... ^A-<up>  |
X  | Auto Redial ...... ^A-R  Setup Screen .... ^A-S  Receive Files . ^A-<down>|
X  | Keyboard Macros .. ^A-M  Change Directory. ^A-B  Pass Thru Mode. ^A-T     |
X  | Line Settings .... ^A-P  Clear Screen .... ^A-C  Directory ..... ^A-F     |
X  | Exit Pcomm ....... ^A-X  Toggle Duplex ... ^A-E  Screen Dump ... ^A-G     |
X  | Unix Gateway ..... ^A-4  Hang Up Phone ... ^A-H  Start Data Log. ^A-1     |
X  |                          Printer On/Off .. ^A-L  Toggle Log .... ^A-2     |
X  |                          Toggle CR-CR/LF . ^A-3                           |
X  |                          Break Key ....... ^A-7                           |
X  |                                                                           |
X  +------------------------ Press any key to continue ------------------------+
X
X	2.4 Exit Pcomm
X
X	To exit Pcomm, you type ^A and "x" to access the exit window.
X
X	+-- Exit -----------------------+
X	|                               |
X	|   Exit to Unix? (y/n): _      |
X	|                               |
X	+-------------------------------+
X
X	To exit, you press the letter "y" (carriage return not required).
X
X	3. SETUP SCREENS
X
X	Pcomm allows you to change many of the default parameters.   The
X	setup  screen  is  accessed by typing ^A and "s".  The following
X	screen shows the sub-menu choices:
X
X	------------------------ Setup Menu ----------------------------
X
X				1) TTY Setup
X				2) Modem Setup
X				3) Terminal Setup
X				4) General Setup
X				5) ASCII Transfer Setup
X				6) External Proctol Setup
X				S) Save setup to disk
X
X	----------------------------------------------------------------
X	OPTION ==> _                                 Press <ESC> to exit
X
X	To select one of the sub-menu choices, you type the  number  (or
X	letter) at the "OPTION ==>" prompt.  To exit from a sub-menu and
X	return to this setup menu screen, you press the escape key.
X
X	Changes made affect the current Pcomm session only.  To make the
X	changes become the default, you select the "s" option.
X
X	3.1 Prompting
X
X	There are several different types of prompts used in  the  setup
X	screens.   The  prompts  use the bottom two lines on the display
X	for user input and to give more information  on  what  is  being
X	asked.   Pcomm  will  beep at any illegal input.  The escape key
X	<ESC> will abort any prompt.  The prompt types are:
X
X		+o  Character  prompt.   Asks  you  to  input  a   single
X		character.
X
X		+o String prompt.  Asks you to input a word or  group  of
X		characters.
X
X		+o Numeric prompt.  Asks you for a number.
X
X		+o Menu prompt.  Shows  a  selection and  allows  you  to
X		choose  the  current  selection by pressing the carriage
X		return or change the selection  by  pressing  the  space
X		bar.
X
X	3.2 TTY setup
X
X	The TTY setup allows you to assign the serial ports  that  Pcomm
X	is allowed to use, and what is attached to each port.  A typical
X	TTY setup screen might look like this:
X
X	-------------------------- TTY Setup ---------------------------
X
X		 TTY name        Modem name      Init speed
X
X		 1) tty10        HAYES               0
X		 2) tty11        HAYES               0
X		 3) tty12        DIRECT              0
X		 4) tty13        TELEBIT             0
X		 5) tty13        FAST_TELEBIT        0
X		 6)                                  0
X		 7)                                  0
X		 8)                                  0
X		 9)                                  0
X		10)                                  0
X
X		A) Add a TTY entry
X		D) Delete a TTY entry
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	You may edit an entry by typing the entry number at the  prompt.
X	To add an entry, you type "A" at the prompt, etc.
X
X	The TTY setup fields are:
X
X		1) TTY name.  This is the name of the serial  port  that
X		Pcomm  will  be  allowed  to  use.  Notice that the path
X		component of the name, "/dev/" is not used.
X
X		2) Modem name.  This a key word that is  used  later  to
X		link the modem database with the TTY database.  The name
X		could be any combination of  letters  or  numbers  (both
X		upper and lower case).
X
X	NOTE:  All hard-wired  ports  (ports  without  modems  attached)
X	*must* use the word "DIRECT" for the modem name.
X
X		3) Init speed.  Normally Pcomm will initialize the modem
X		at  the baud rate in the dialing directory.  If the init
X		speed is non-zero, the initialization string  is  always
X		sent  at  the  specified  baud  rate.   The baud rate is
X		selected from a "menu prompt".  See Appendix C  for more
X		information about the use of this feature.
X
X	NOTE:  It is often best to put the fastest modem/TTYs at the end
X	of the TTY database.
X
X	3.3 Modem setup
X
X	The modem setup contains the commands to make  the  modem  dial,
X	hang up the phone, etc.  A typical modem setup screen might look
X	like this:
X
X	-------------------------- Modem Setup -------------------------
X
X		 1) Modem name (1 of 4) ... HAYES
X		 2) Modem init string ..... ATS7=45S11=70E0Q0V1X4&D2!
X		 3) Dialing command ....... ATDT
X		 4) Dialing cmd suffix .... !
X		 5) Hang up string ........ ~~+++~~ATH0!
X		 6) Auto baud detect ...... Y
X		 7) 300 baud connect ...... CONNECT!
X		 8) 1200 baud connect ..... CONNECT 1200
X		 9) 2400 baud connect ..... CONNECT 2400
X		10) 4800 baud connect .....
X		11) 9600 baud connect .....
X		12) 19200 baud connect ....
X		13) No connect string 1 ... BUSY
X		14) No connect string 2 ... VOICE
X		15) No connect string 3 ... NO CARRIER
X		16) No connect string 4 ...
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	The fields of the modem setup are:
X
X		1) Modem name.  This is the  key  word  that  links  the
X		modem  database with the TTY database.  A menu prompt is
X		used  to  select  the  modem  name  (and  the  remaining
X		parameters  that  go  with  it).   The  "(1 of 4)" field
X		indicates there are additional modems in the database.
X
X		2) Modem initialization string.  This  is  sent  to  the
X		modem whenever the port is selected.  Consult your modem
X		manual for the codes to be used.  Notice the use of  the
X		"!"  character.  This is the "character synonym" for the
X		carriage return.
X
X	NOTE:  See section  3.5  for  the  complete  list  of  character
X	synonyms.  To remove the special meaning of a character synonym,
X	you must prepend a "\" to the character.
X
X		3) Dialing command.  The first part of  the  command  to
X		make  the  modem  dial.   It  is  assumed that the phone
X		number will immediately follow.
X
X		4) Dialing command suffix.  The last part of the command
X		to  make  the  modem  dial.   Typically this will be the
X		carriage return "character synonym".
X
X		5) Hang up string.  The command to make the  modem  hang
X		up  the  phone.   The  character  synonym for a 1 second
X		pause is the tilde "~" character.
X
X		6) Auto baud detect.  Should Pcomm attempt to change the
X		baud  rate  of  the  TTY  to  the baud rate matching the
X		connect  string?   This  feature  requires  the  connect
X		strings to be unique.
X
X		7-12) Connect strings.  The  return  messages  when  the
X		modem   has  connected  to  the  remote.   If  different
X		messages are returned for each baud rate  at  which  the
X		modem answers, then they should be specified.
X
X	NOTE:  Pcomm uses the connect strings to  determine  which  baud
X	rates  the  modem is capable of supporting.  For example, if the
X	4800 baud connect string  is  empty,  Pcomm  assumes  the  modem
X	can not support 4800 baud.
X
X	NOTE:  If two connect strings are very  similar,  (for  example,
X	"CONNECT"  is  entirely  contained  in  "CONNECT  1200"),  it is
X	possible that the return code from  the  modem  will  match  the
X	incorrect  string.   To  prevent  this  from  happening, use the
X	command synonym for the carriage return to terminate the shorter
X	string (for example, use "CONNECT!" instead of "CONNECT").
X
X		13-16) No connect strings.  The messages returned by the
X		modem when no connection is made.
X
X	3.4 Terminal setup
X
X	The terminal setup allows you to define  the  hot  key  and  the
X	mapping of the end-of-line characters.  A typical terminal setup
X	menu will look like this:
X
X	---------------------- Terminal Setup --------------------------
X
X			1) Hot key (decimal) ...... 1
X			2) ASCII version of hot ... ^A
X
X			3) Duplex ................. FULL
X			4) Flow control ........... XON/XOFF
X			5) CR translation (in) .... CR
X			6) CR translation (out) ... CR
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	The fields in the terminal setup are:
X
X		1) Hot key.  This is  the  decimal  code  for  the  user
X		definable  hot key.  Consult an ASCII/decimal conversion
X		chart for the decimal values of other characters.
X
X		2) ASCII version of hot  key.   This  is  the  printable
X		version  of the hot key used by Pcomm in the help screen
X		and status line.
X
X		3) Duplex.  A menu prompt is  shown  to  select  between
X		FULL  duplex  and HALF duplex.  In the half duplex mode,
X		characters sent to the remote system are  also  sent  to
X		the  screen.   (The  duplex mode can also be changed "on
X		the fly" by the ^A-E command.)
X
X		4) Flow control.  A  menu  prompt  is  shown  to  select
X		between  XON/XOFF  flow  control  and  NONE.   The  flow
X		control selected here is used only during  the  terminal
X		session, not during file transfers.
X
X		5-6) CR translations.  The  end-of-line  characters  for
X		both  incoming  and  outgoing  carriage  returns  can be
X		altered to suit  the  remote  system's  needs.   A  menu
X		prompt provides the following choices:
X
X			+o CR (no translation)
X			+o CR/LF translate CR to CR/LF
X
X		The incoming CR translation can also be changed "on  the
X		fly" with the ^A-3 command.
X
X	3.5 General setup
X
X	The general setup allows you to define  the  character  synonyms
X	and  the  default  files  used  by  the  screen  dump  and other
X	features.  A typical general setup screen might look like this:
X
X	------------------------- General Setup ------------------------
X
X			 1) Default log file ....... pcomm.log
X			 2) Screen dump file ....... pcomm.dump
X
X			 3) Strip high bit  ........ YES
X
X			 4) Pause character ........ ~
X			 5) CR character ........... !
X			 6) CTRL character ......... ^
X			 7) ESC character .......... |
X			 8) Break character ........ %
X
X			 9) Aborted downloads ...... KEEP
X
X			10) Connect delay (sec) .... 35
X			11) Redial delay (sec) ..... 5
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	The general setup fields are:
X
X		1) Default log file.  The file name to be  used  as  the
X		default  when the data logging is activated (^A-1).  The
X		log file name can be changed "on the fly"  by  the  ^A-1
X		command.
X
X		2) Screen dump file.  The file name to be used  for  the
X		screen dump command (^A-G).
X
X		3) Strip high bit.  Should Pcomm strip the eighth bit on
X		incoming  and outgoing characters?  A menu prompt allows
X		you to select YES or  NO.   This  feature  is  not  used
X		during file transfers.
X
X		4-8) Character synonyms.  These are symbols  that  Pcomm
X		uses to represent special characters (or perform special
X		functions) when sending commands to the modem.  Synonyms
X		are   useful   for   entering   and  displaying  special
X		characters in a human readable form.  The synonyms are:
X
X			+o Pause for 1 second
X			+o The carriage return character (control-M)
X			+o Convert the next character to control-xx
X			+o The escape character (control-[)
X			+o Send a modem break
X
X	NOTE:  To prevent the special meaning of one of these characters
X	prepend a "\" to it.
X
X		9) Aborted downloads.  When a download  aborts  (fails),
X		should  the  partially completed file be kept?  The menu
X		prompt allows "KEEP" or "DELETE".
X
X		10) Connect delay.  The number  of  seconds  Pcomm  will
X		wait for the modem to return a status code.
X
X		11) Redial delay.  The number of seconds to wait  before
X		Pcomm tries to call the number again.
X
X	3.6 ASCII transfer setup
X
X	This setup screen allows you to select options to  be  used  for
X	ASCII  uploads  and  downloads.   A typical ASCII transfer setup
X	will look like this:
X
X	---------------------- ASCII Transfer Setup --------------------
X
X				  ASCII UPLOAD
X
X			1) Echo locally ........... NO
X			2) Expand blank lines ..... NO
X			3) CR delay (ms) .......... 0
X			4) Pace the output ........ NO
X			5) CR translation ......... NONE
X			6) LF translation ......... ADD CR
X
X				 ASCII DOWNLOAD
X
X			7) Transfer timeout (sec) . 5
X			8) CR translation ......... STRIP
X			9) LF translation ......... NONE
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	The fields are:
X
X		1) Echo locally.  This is similar to the  duplex  option
X		in  that  it  copies  outgoing characters to the screen.
X		The options are YES and NO.
X
X		2) Expand blank lines.  Should a blank line (LF alone)
X		be expanded to a space and LF?  Some BBS systems use a
X		blank line to signal the end of an  ASCII  upload.   The
X		options are YES and NO.
X
X		3) CR delay.  The delay in milliseconds to be used  when
X		sending a CR.  The menu prompt limits the choice to 0,
X		100, or 150.
X
X		4) Pace output.  Should each character sent be  delayed?
X		Very  old  BBS  systems may require this.  The choice is
X		YES or NO.
X
X		5)  CR  translation.   The  menu  prompt  provides   the
X		following choices for upload translations:
X
X			+o NONE (no translation)
X			+o ADD LF translate CR to CR/LF
X			+o STRIP remove the CR character
X
X		6) LF translation. Same as above except the choices are:
X
X			+o NONE (no translation)
X			+o ADD CR translate LF to CR/LF
X			+o STRIP remove the LF character
X
X		7) Transfer timeout.  The number of seconds to  be  used
X		to determine the end of an ASCII download.  You can halt
X		the transfer before the timer goes off  by  hitting  the
X		<ESC> key.
X
X		8-9) Same as 5) and 6) above, except the translations
X		apply to ASCII downloading.
X
X	3.7 External protocol setup
X
X	This setup screen allows you to imbed the name of external  file
X	transfer  programs  into  the list of available protocols.  When
X	transferring files, the external program name will appear on the
X	list of options along with the built-in protocols.
X
X	-------------------- External Protocol Setup -------------------
X
X				    UPLOAD
X
X		Name     Command Line             Requires file list?
X	     1) zmodem   sz                               Y
X	     2)                                           N
X	     3)                                           N
X
X				   DOWNLOAD
X
X		Name     Command Line             Requires file list?
X	     4) zmodem   rz                               N
X	     5)                                           N
X	     6)                                           N
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	To change a line (or add a new one), enter the  line  number  at
X	the  prompt.   You  will  be  prompted for the Name, the Command
X	Line, and the 'Requires file list?' flag.  To remove  an  entry,
X	enter a single space character at the Name prompt.
X
X	The Command Line is the Unix command  that  you  would  normally
X	type  in  to invoke the program (minus the names of the files to
X	be transferred).  The  last  field  in  the  setup  is  used  to
X	indicate  whether  or not Pcomm should prompt for a list of file
X	names to be added to the command.
X
X	NOTE:  Pcomm adds a single space character and  the  file  names
X	(if any) to the end of the command.
X
X	NOTE:  The program itself isn't "imbedded" into Pcomm (it  still
X	gets  called like any other external program), only the name and
X	invocation information is actually incorporated into Pcomm.
X
X	4. MAJOR FUNCTIONS
X
X	When Pcomm is invoked without  the  "-f"  command  line  option,
X	you're  placed  in  the  terminal mode with a blank screen and a
X	status line.  However, since Pcomm hasn't yet selected a  serial
X	port  to  use, characters typed at the blank screen are ignored.
X	Normally the first command you'll use is ^A-D to  bring  up  the
X	dialing directory menu.
X
X	4.1 Dialing directory
X
X	To dial another system, you type  ^A-D  to  access  the  dialing
X	directory menu, then enter the entry number at the prompt.
X
X	The entry number could be preceded by a  special  long  distance
X	dialing  code  such as "#5" in lieu of "5" alone.  Long distance
X	codes could contain access numbers such as those  that  MCI  and
X	Sprint require.
X
X	A typical dialing directory will look like this:
X
X    +----------------------------------------------------------------------+
X    |                 D I A L I N G       D I R E C T O R Y                |
X    |----------------------------------------------------------------------|
X    |       Name                  Number       Baud P D S Dpx  Script/TTY  |
X    |  1- Abbey Road        1 (512) 590-6036   2400-N-8-1  F               |
X    |  2- Tel-Med-Com               555-8686   9600-E-7-1  F               |
X    |  3- C Board           1 (619) 722-8724   2400-N-8-1  F               |
X    |  4- Crest             1 (213) 471-2518   2400-N-8-1  F   Sample      |
X    |  5- Last Chance       1 (219) 762-8411   2400-E-7-1  F               |
X    |  6- Killer            1 (214) 827-1994   1200-E-7-1  F               |
X    |  7- System A (direct)                   19200-N-8-1  F   tty12       |
X    |  8-                                      1200-E-7-1  F               |
X    |  9-                                      1200-E-7-1  F               |
X    | 10-                                      1200-E-7-1  F               |
X    |                                                                      |
X    |   ==> _    R Revise           M Manual Dialing    Entry to Dial      |
X    |            P LD Codes         D Delete Entry      <CR> Scroll Down   |
X    |            <up>/<down> Page   L Print Entries     <ESC> Exit         |
X    |                                                                      |
X    |   LD Codes Active: @ #                                               |
X    |                                                                      |
X    +----------------------------------------------------------------------+
X
X	The fields of the dialing directory are:
X
X		+o Name.  The name of the remote system.
X
X		+o Number.  The telephone number to the remote system.
X
X	NOTE:  The "(", ")", "-", and  space  characters  are  just  for
X	looks,  and  don't  get  sent  to  the  modem.   To  prevent the
X	stripping of one of these characters, prepend a "\" to it.
X
X		+o Line settings.  The communications settings to be used
X		when dialing that entry.  The range of values are:
X
X			Baud	Parity     Data bits  Stop bits
X			-----	--------   ---------  ---------
X			300	N - none	7	1
X			1200	E - even	8	2
X			2400	O - odd
X			4800
X			9600
X			19200
X
X		+o Duplex.  The duplex mode.  Either "F" for full or  "H"
X		for half.
X
X		+o Script/TTY.  The name of the shell script to  be  used
X		as  a  auto-login  "chat"  sequence.  This field is also
X		used to specify a particular TTY for the entry.
X
X	NOTE:  On all hard-wired ports, the  script  field  is  used  to
X	contain  the  name  of  the  port.   For  example, if tty12 is a
X	hard-wired port to "System A", then the dialing directory  entry
X	for "System A" will have "tty12" in the script field.
X
X	The commands at the dialing directory prompt are:
X
X		R) Revise (or add) a dialing  directory  entry  or  long
X		distance  dialing code.  Prompts you to save the changes
X		to disk.  A typical revise screen would look like this:
X
X	+--------------------------------------------------------------+
X	|                                                              |
X	|   Entry to revise? _          (Entry Number, +,-,@,#)        |
X	|                                                              |
X	+--------------------------------------------------------------+
X
X		If a dialing directory entry is selected, each field  of
X		the  entry  is shown with its current settings.  You can
X		enter a new value, press a carriage return to skip  past
X		a  field,  or  enter a single space character to erase a
X		field.  An <ESC> at any field will abort the command.
X
X		P) Print (display) the long distance dialing codes.
X
X		<up>/<down>) Scroll the dialing directory up or down  10
X		lines.   Use  the  up and down arrow keys to access this
X		feature.
X
X		M) Manual dial.  Prompts you for a phone  number  rather
X		than using a number already in the dialing directory.
X
X		D) Delete an entry or a range of entries.   Prompts  you
X		to save the changes to disk.
X
X		L) Print.  Send the dialing directory to the printer  or
X		a file of your choice.
X
X		1-100) Entry number.  Dial  the  phone  for  that  entry
X		number.   If  the  script  field  contains the name of a
X		valid Unix shell script, that script is  "played"  after
X		the  connection is made to perform the auto-login "chat"
X		sequences.  See  section  8  of  this  manual  for  more
X		details  on  the  format  and  use  of  auto-login shell
X		scripts.
X
X	NOTE:  To access the port directly without dialing  (perhaps  to
X	send  the dial codes yourself), select an empty entry or enter a
X	single space character at the phone number prompt of the  manual
X	dial option.
X
X		<CR> Carriage return.  Scroll the dialing directory down
X		one line.
X
X	4.2 Redial
X
X	The redial feature is a misnomer; it really is a queuing  system
X	that  allows  Pcomm to dial several numbers in a cycle until one
X	of them answers.
X
X	When you invoke the redial command with  ^A-R,  you're  prompted
X	for  a list of dialing directory numbers.  (You may also prepend
X	a long distance code to the entry number).
X
X	+-- Redial Queue ----------------------------------------------+
X	|                                                              |
X	|   Directory Entry Number(s): _                               |
X	|                                                              |
X	|                  (<CR> for previous numbers)                 |
X	+--------------------------------------------------------------+
X
X	To redial the previous number, press a carriage return alone at
X	the prompt.  An <ESC> aborts this command.
X
X	4.3 Keyboard macros
X
X	Keyboard macros are used as a shortcut  to  send  commonly  used
X	strings  to  the  remote system with only a few keystrokes.  The
X	characters used to identify the macros are  the  shifted  number
X	keys.   For  example,  if the string "hello" was assigned to the
X	"!" key (the shifted number 1 key), then when  you  press  ^A-!,
X	the string "hello" is sent to the remote.
X
X	To review or edit the  keyboard  macros,  you  type  ^A-M.   The
X	following screen will appear:
X
X		+------------------------------------------------------+
X		|                   Keyboard Macros                    |
X		|------------------------------------------------------|
X		|                                                      |
X		|  ^A-! hello                                          |
X		|  ^A-@                                                |
X		|  ^A-#                                                |
X		|  ^A-$                                                |
X		|  ^A-%                                                |
X		|  ^A-^                                                |
X		|  ^A-&                                                |
X		|  ^A-*                                                |
X		|  ^A-(                                                |
X		|  ^A-)                                                |
X		|                                                      |
X		|  Macro key to revise: _                              |
X		|                                                      |
X		+---------------- Press <ESC> to continue -------------+
X
X	To edit a macro, you type the macro key character  (without  the
X	leading  hot key).  After typing the new string information, you
X	will be prompted to save the changes to disk.  To erase an entry
X	enter a single space character.
X
X	NOTE:  All of the character synonyms described  in  section  3.5
X	are available for use with the keyboard macros.
X
X	4.4 Line settings
X
X	The line settings menu is  invoked  by  ^A-P.   A  typical  line
X	settings menu will look like this:
X
X		+-----------------------------------------------+
X		|                Line Settings                  |
X		|-----------------------------------------------|
X		|                                               |
X		|       Current Settings:  1200,E,7,1           |
X		|                                               |
X		|     1)    300,E,7,1      7)    300,N,8,1      |
X		|     2)   1200,E,7,1      8)   1200,N,8,1      |
X		|     3)   2400,E,7,1      9)   2400,N,8,1      |
X		|     4)   4800,E,7,1     10)   4800,N,8,1      |
X		|     5)   9600,E,7,1     11)   9600,N,8,1      |
X		|     6)  19200,E,7,1     12)  19200,N,8,1      |
X		|                                               |
X		|   Parity       Data Bits       Stop Bits      |
X		|   13) Odd      14) 7 bits      16) 1 bit      |
X		|                15) 8 bits      17) 2 bits     |
X		|                                               |
X		|   18) Save Changes      YOUR CHOICE: _        |
X		|                                               |
X		+------------- Press <ESC> to return -----------+
X
X	While dialing  a  remote,  the  line  settings  in  the  dialing
X	directory  entry  are  automatically  used.   Therefore the line
X	settings menu is used to fine tune the values during a  terminal
X	session or to select the parameters for manual dialing.  You can
X	make the current setting the  default  by  selecting  the  "Save
X	Changes" option.
X
X	The current line settings are also displayed in the status line.
X
X	NOTE:  During file transfers,  certain  parameters  (namely  the
X	data  bits  and parity) will be temporarily changed.  The status
X	line will *not* reflect these temporary promotions.
X
X	4.5 Exit Pcomm
X
X	To exit Pcomm, you type ^A-X.  The phone is hung up (if  a  call
X	was  in  progress),  the  print  and  data  logging features are
X	closed, and the TTY resources are released.
X
X	NOTE:  Pcomm drops the DTR (Data Terminal  Ready)  on  the  port
X	before exiting to Unix.
X
X	4.6 Unix gateway
X
X	To temporarily suspend Pcomm and spawn a Unix  shell,  you  type
X	^A-4.   To  return  to  Pcomm,  you  exit  the  shell  normally,
X	typically with ^D or "exit".
X
X	NOTE:  The SHELL environmental variable  is  used  to  determine
X	which program to invoke.
X
X	5. UTILITY FUNCTIONS
X
X	The following commands perform secondary functions.
X
X	5.1 Program information
X
X	To display the opening information screen, you type ^A-I.  Press
X	any key to return to the terminal mode.
X
X	5.2 Setup screen
X
X	The setup screens are described in detail in section 3  of  this
X	manual.
X
X	5.3 Change directory
X
X	To change the  current  working  directory  while  still  inside
X	Pcomm,  you  type  ^A-B.  A screen similar to the following will
X	appear:
X
X	+-- Change directory ------------------------------------------+
X	|                                                              |
X	|   Current directory: /usr/egray                              |
X	|   New directory: _                                           |
X	|                                                              |
X	+--------------------------------------------------------------+
X
X	Abbreviations known to the shell are  acceptable;  for  example,
X	the  "~"  character  will be translated to the home directory in
X	the csh or ksh shell.
X
X	5.4 Clear screen
X
X	To clear the local screen and home the cursor, you type ^A-C.
X
X	NOTE:  The remote system may not  "know"  the  screen  has  been
X	cleared,  and  may  make  assumptions  about the screen that are
X	incorrect.
X
X	5.5 Toggle duplex
X
X	The ^A-E command changes the duplex mode from FULL to  HALF,  or
X	from  HALF  to  FULL.   The status line shows the current duplex
X	mode.
X
X	5.6 Hang up the phone
X
X	To hang up the phone, you type ^A-H.  The  word  "disconnecting"
X	will briefly show in the status line.
X
X	NOTE:  Pcomm drops the DTR (Data Terminal Ready)  after  sending
X	the hang up string.
X
X	5.7 Printer logging
X
X	The ^A-L command toggles the printer logging  on  or  off.   The
X	current printer status is displayed in the status line.
X
X	NOTE:  Since all printing goes to the normal  Unix  print  spool
X	program,  the  characters  will not print on the printer as they
X	appear on the screen.  The printing will actually begin when the
X	printer  logging  is  turned *off* and the complete print job is
X	sent to the spool.
X
X	NOTE:  Due to a technical limitation of Pcomm, characters  typed
X	while in the half duplex mode will not appear in the print log.
X
X	5.8 Toggle CR - CR/LF
X
X	The  ^A-3  command  toggles  the   incoming   line   termination
X	characters  between  CR  and CR/LF.  The status line shows
X	the current settings (in the next to the last field).
X
X	5.9 Break
X
X	The ^A-7 command sends a modem break to the remote system.   The
X	word "break" is (very) briefly displayed on the status line.
X
X	NOTE:  This not the same as the break key on  the  keyboard  (we
X	don't  want to send a break to the local system, we want to send
X	it to the *remote*).
X
X	6. FILE FUNCTIONS
X
X	One of  the  most  important  features  of  a  telecommunication
X	program  is  the  ability to transfer files.  The following file
X	transfer protocols are implemented:
X
X	protocol        packet          error           multiple
X	name            size            detection       files?
X	---------       --------        ------------    --------
X
X	xmodem          128             checksum/CRC    no
X	xmodem-1k       128/1024        checksum/CRC    no
X	modem7          128             checksum        yes *1
X	ymodem          128/1024        CRC             yes *2
X	ymodem-g        128/1024        none *3         yes
X	ASCII           none            none            no
X	zmodem *4       128/1024        CRC             yes
X	(external)	?		?		?
X
X	Notes:  1 CP/M style file name
X		2 MSDOS style file name and file size
X		3 Not needed!
X		4 zmodem is implemented as an external program
X
X	NOTE:  The built-in protocols that send file  name  information,
X	convert  the  Unix  style  file  name  to  fit  the  MSDOS  name
X	restrictions.
X
X	6.1 External protocols
X
X	The external  "protocol"  is  really  a  method  of  running  an
X	external  program from Pcomm to accomplish a file transfer.  The
X	most common use of this feature would be to run Kermit  or  some
X	proprietary  program.
X
X	Frequently used external file transfer programs (such as zmodem)
X	can  have  their  names  imbedded  into  the  list  of available
X	protocols by using the External Protocol Setup in section 3.7.
X
X	To abort an external file transfer, you hit the <ESC> key.   All
X	other characters typed at the keyboard are ignored.
X
X	NOTE: The external protocol feature can also be used (misused?)
X	to pipe the output of a Unix command to the remote.
X
X	6.2 Send files
X
X	To send a file to the remote, you'll first have to instruct  the
X	remote system to receive the file, then type ^A-"up arrow".  The
X	following screen will appear:
X
X					+----- Upload -----+
X					|                  |
X					|  1) xmodem       |
X					|  2) xmodem-1k    |
X					|  3) modem7       |
X					|  4) ymodem       |
X					|  5) ymodem-g     |
X					|  6) ASCII        |
X					|  7) zmodem       |
X					|  E) (external)   |
X					|                  |
X					|  <ESC> to Abort  |
X					|                  |
X					|  Protocol: _     |
X					+------------------+
X
X	You then select the type of protocol at the prompt, and  another
X	window similar to this will appear:
X
X	+-- Send xmodem -----------------------------------------------+
X	|                                                              |
X	|   Enter filename: _                                          |
X	|                                                              |
X	+--------------------------------------------------------------+
X
X	Now you type in the file name  or  names  you'd  like  to  send.
X	Wildcards known to the shell are acceptable.
X
X	Now the file transfer actually begins.  A screen similar to  the
X	following is displayed during the transfer:
X
X				+-------------- Uploading -------------+
X				|                                      |
X				|            Protocol: xmodem          |
X				|           File name: main.c          |
X				|           File size: 4420            |
X				|  Error check method: CRC             |
X				|   Est transfer time: 0:00:50         |
X				|         Block count: 5               |
X				|    Percent complete: 11.2%           |
X				|   Bytes transferred: 640             |
X				|   Errors this block: 0               |
X				|   Total error count: 0               |
X				|        Last message: NONE            |
X				|                                      |
X				+------- Press <ESC> to abort ---------+
X
X	As  the  transfer  progresses,  the  "block   count",   "percent
X	complete",  and  "bytes transferred" fields will be continuously
X	updated.  If errors occur the "errors  this  block"  and  "total
X	error count" fields will be updated and the "last message" field
X	will contain a message about the error.
X
X	At the end of the transfer, Pcomm will beep and  return  to  the
X	terminal  mode.   If  an  error  occurred  and  the transfer was
X	aborted, you will  be  prompted  to  acknowledge  the  error  by
X	pressing a key before returning to the terminal mode.
X
X	6.3 Receive files
X
X	To receive a file (or group of  files)  from  a  remote  system,
X	you'll  have  to  first  instruct  the  remote system, then type
X	^A-"down arrow".  Receiving a file  is  basically  the  same  as
X	sending a file.
X
X	NOTE:  Some systems  do  not  pad  the  end  of  the  file  with
X	control-Z's  and  therefore  files  might  grow  in  length when
X	received.
X
X	NOTE:  Due  to  a  technical  limitation  of  Pcomm,  characters
X	received  during  an  ASCII  download  will  not reappear on the
X	screen when you return to the terminal mode.
X
X	6.4 Pass thru mode
X
X	The pass through mode is used when you have two or more machines
X	in  a  communications  daisy chain.  The following diagram shows
X	an example of this type of arrangement:
X
X		+---------+          +---------+          +---------+
X		| IBM PC  |          | Unix    |          | IBM PC  |
X		| running | -------> | running | -------> | running |
X		| ProComm | <------- | Pcomm   | <------- | RBBS    |
X		+---------+          +---------+          +---------+
X
X	If a file is to be transferred from  the  last  machine  to  the
X	first   machine,  the  middle  machine  must  appear  completely
X	transparent.  The middle machine must "forward the data" without
X	altering it in any way.  The pass through mode "expires" after a
X	designated  period  of  inactivity,  after  which  the  user  is
X	returned to the terminal mode.
X
X	To access the pass through mode, you type ^A-T.  The following
X	screen will appear:
X
X	+-- Pass Thru Mode --------------------------------------------+
X	|                                                              |
X	|   Enter the expiration time (5-60 sec) : _                   |
X	|                                                              |
X	+--------------------------------------------------------------+
X
X	NOTE:  While in the pass through mode, no Pcomm command  to  the
X	middle  machine  will  be honored.  Therefore, the *only* way to
X	exit this mode is to not type anything on the keyboard until the
X	expiration period has elapsed.
X
X	NOTE:  The baud rates to and from the middle machine need not be
X	the same, however the slowest speed determines the overall speed
X	of the transfer (the weakest link in the chain).
X
X	6.5 Directory
X
X	To obtain a listing of a directory on  the  local  system  while
X	still  running  Pcomm, you type ^A-F.  The following screen will
X	appear:
X
X	+-- List Directory --------------------------------------------+
X	|                                                              |
X	|   Current directory: /usr/egray                              |
X	|   File spec (wildcards allowed): _                           |
X	|                                                              |
X	+--------------------------------------------------------------+
X
X	Abbreviations known to the shell  are  valid.   Output  is  sent
X	through a "more" like program.
X
X	NOTE:  Since we're really doing a popen() to the  "ls"  command,
X	additional command line options are also valid.
X
X	6.6 Screen dump
X
X	To dump the contents of the current screen  (minus  any  windows
X	showing)  you type ^A-G.  The contents of the screen are written
X	to the file specified in the general setup for this purpose.  If
X	the file already exists, the screen contents are appended to the
X	file.  The message "screen dump"  will  briefly  appear  in  the
X	status line.
X
X	NOTE:  The screen contents are  subject  to  the  available  VCS
X	(video  command  sequence) emulation, so an exact representation
X	is not guaranteed.
X
X	6.7 Start data log
X
X	To start the data logging, or change  the  file  used  for  data
X	logging, you type ^A-1.  The following screen will appear:
X
X	+-- Start Data Logging ----------------------------------------+
X	|                                                              |
X	|   Default log file: pcomm.log                                |
X	|   New log file: _                                            |
X	|                                                              |
X	+--------------------------------------------------------------+
X
X	To keep the default file, just press a carriage  return  at  the
X	prompt,  otherwise,  enter a new file name.  If the file already
X	exits, the new data is appended to the file.
X
X	The status of the logging is shown in the status line.
X
X	NOTE:  Due to a technical limitation of Pcomm, characters  typed
X	while in the half duplex mode will not appear in the log file.
X
X	6.8 Toggle logging
X
X	To temporarily suspend data logging or to start it again without
X	being prompted for the file name, you type ^A-2.
X
X	7. DIALING WINDOW
X
X	While Pcomm is dialing another system, a screen similar  to  the
X	following is shown:
X
X    +----------------------------------------------------------------------+
X    |                    D I A L I N G      W I N D O W                    |
X    |----------------------------------------------------------------------|
X    |                                                                      |
X    |                        System name: C Board                          |
X    |                        Pass number: 1                                |
X    |               Elapse time this try: 4                                |
X    |              Time at start of dial: 14:53:36                         |
X    |          Time at start of this try: 14:53:37                         |
X    |                 Connect delay time: 35                               |
X    |                  Redial delay time: 5                                |
X    |                         Script/TTY:                                  |
X    |                 Result of last try:                                  |
X    |                                                                      |
X    |   <SPACE>: Recycle    <DEL>: Remove from queue    E: Change delays   |
X    |                                                                      |
X    +------------------------- Press <ESC> to abort -----------------------+
X
X	The options available during the dialing window are:
X
X		SPACE) Press the space bar to stop the  dialing  of  the
X		current  entry and go on to the next entry in the queue.
X		If there is only one entry in the queue, that number  is
X		redialed.
X
X		DEL) Press the DEL key to remove the current number from
X		the queue.
X
X		E) Press the letter "E"  to  change  the  connect  delay
X		time,  or  the  redial  delay  time  (the  pause between
X		dialing attempts).  You will be  prompted  to  save  the
X		changes to disk.
X
X	NOTE:  While the DEL and E  options  are  being  processed,  the
X	dialing is temporarily suspended.
X
X	8. AUTO-LOGIN SCRIPTS
X
X	Pcomm doesn't have a built-in script language, instead  it  uses
X	Unix  shell  scripts  (Bourne  shell, C shell, or Korn shell) to
X	perform the necessary "chat" sequences to log a  user  on  to  a
X	remote system.
X
X	Since shell scripts are run  "outside"  of  Pcomm,  they  cannot
X	contain  Pcomm  commands.   For  example,  an  auto-login script
X	cannot dial a phone number or turn on the data logging  feature.
X	The  auto-login  scripts  are  run *after* the connection to the
X	remote system has been made.
X
X	You may hit the <ESC> key at any time  to  abort  an  auto-login
X	script  before  it has completed.  All other characters typed at
X	the keyboard are ignored.
X
X	WARNING:  Any  file  that  has  a  "clear  text"  (un-encrypted)
X	version  of your password is a significant security threat.  You
X	should remove the read permission to all others.
X
X	In order to assist in the creation of  auto-login  scripts,  the
X	following external programs have been provided.
X
X	8.1 Waitfor Command
X
X	The waitfor command has the following syntax:
X
X		waitfor -n string
X
X	where "n" is the number of seconds to wait and "string"  is  the
X	string to wait for.
X
X	Waitfor returns a 0 if the string was found, a 1  if  it  didn't
X	find  the string within the allotted time, and a -1 if there was
X	an error.  Waitfor returns immediately if the string is found.
X
X	The waitfor command would typically  be  used  in  a  script  to
X	indicate that the desired prompt has appeared.  For example:
X
X		waitfor -5 "ogin:"
X		if [ "$?" -eq 0 ]
X		then
X			echo "egray"
X		fi
X
X	would wait up to 5 seconds  for  the  string  "ogin:".   If  the
X	return  code  is  0  (the  strings  did  apear), send the string
X	"egray" (my user ID).
X
X	NOTE:  Upper and lower case letters  are  considered  different.
X	If  you are not sure if the prompt is "Login:" or "login:", then
X	skip the first letter in the string and use "ogin:".
X
X	8.2 Matches Command
X
X	The matches command has the following syntax:
X
X		matches string1 string2
X
X	Matches returns a 0 if string2  is  contained  in  string1,  and
X	returns a 1 if it does not.  Unlike waitfor, the matches command
X	does not read the TTY port.
X
X	The matches command could be used to test string values such as:
X
X		read junk
X		matches $junk "login failed"
X		if [ "$?" -eq 0 ]
X		then
X			exit
X		fi
X	
X	8.3 Modem_break Command
X
X	The modem_break command performs a modem break on the  TTY.   It
X	would  often  be  used  to  tell  the remote system to switch to
X	another baud rate.
X
X	The modem_break program has no command line arguments.
X
X	8.4 Examples
X
X	It is not my intention to teach the reader the  fundamentals  of
X	Unix  shell  programming.   There  are several good books on the
X	subject available in stores.
X
X	Remember to add execute permission to the file  and  remove  the
X	read permission to all others.
X
X	The simplest auto-login script may contain the following:
X
X		# send a <CR>
X		echo ""
X		# wait 5 seconds for the login prompt
X		waitfor -5 ogin:
X		# send my user ID
X		echo "egray"
X		# wait 5 seconds for the password prompt
X		waitfor -5 assword:
X		# send my password
X		echo "abcdefg"
X		# return to Pcomm
X		exit 0
X
X	A more complex script is required if the user must send a  modem
X	break to syncronize the baud rate of the remote.  For example:
X
X		echo ""
X		try=0
X		# loop until done
X		while true
X		do
X			# wait 5 seconds for the login prompt
X			waitfor -5 ogin:
X			# test the exit code of the waitfor command
X			if [ "$?" -eq 0 ]
X			then
X				# send my user ID and exit the loop
X				echo "egray"
X				break
X			fi
X
X			# increment the number of attempts
X			try=`expr $try + 1`
X			# test to see if we should give up
X			if [ "$try" -eq 5 ]
X			then
X				exit 1
X			fi
X
X			# send a modem break and loop again
X			modem_break
X			echo ""
X		done
X		# wait 5 seconds for the password prompt
X		waitfor -5 assword:
X		# test the return code from waitfor
X		if [ "$?" -eq 0 ]
X		then
X			# send my password
X			echo "abcdefg"
X		else
X			exit 1
X		fi
X		# return to Pcomm
X		exit 0
X
X	Appendix A
X
X			  Typical Modem Configuration
X
X	I can't begin to describe how to configure every modem  to  work
X	with  Pcomm.   There  are, however, several guidelines that will
X	apply to virtually any modem.
X
X		1) Pcomm  doesn't  care  about  the  DCD  (Data  Carrier
X		Detect) settings of the modem.
X
X		2) It would be nice (but not essential) if the  loss  of
X		the  DTR  (Data Terminal Ready) caused the modem to hang
X		up.
X
X		3) Pcomm doesn't care if commands are echoed back by the
X		modem  (it  might save a few milliseconds if echoing was
X		turned off).
X
X		4) Some sort of  result  codes  are  required.   Numeric
X		result  codes are ok...  but since they are displayed on
X		the screen, word result codes will make more sense.
X
X		5) If the modem can return different  result  codes  for
X		each  baud  rate at which it answers, then by all means,
X		use them.
X
X		6) Anything that is  returned  by  the  modem,  but  not
X		listed in the modem setup, is ignored.
X
X		7) Systems running uugetty (the  bi-directional  version
X		of  getty that comes with HDB uucp) should include extra
X		commands in the initialization  string  to  assure  that
X		uugetty  switches  to  its  dial  out  mode.   Normally,
X		"AT!~AT!~" causes enough dialogue to  force  uugetty  to
X		release the line.
X
X	For example,  a  2400  baud  Hayes  compatible  modem  might  be
X	configured with the following command:
X
X		AT S7=45 S11=70 E0 Q0 V1 X4 &D2
X
X			AT	Hayes attention command
X			S7=45	Wait 45 seconds for an answer
X			S11=70	70 ms touch tone dialing
X			E0	Don't echo commands (not essential)
X			Q0	Turn result codes on
X			V1	Return word result codes
X			X4	Use as many result codes as you've got
X			&D2	Hang up when DTR is lost (nice to have)
X
X
X	Appendix B
X
X			     AT&T Unix PC 7300/3b1
X				  Dial Codes
X
X	The dialing codes used by the  OBM  (On  Board  Modem)  are  not
X	straight-forward.   The  modem setup, as distributed, looks like
X	this:
X
X	-------------------------- Modem Setup -------------------------
X
X		 1) Modem name (1 of 2) ... OBM
X		 2) Modem init string .....
X		 3) Dialing command ....... %
X		 4) Dialing cmd suffix .... @
X		 5) Hang up string ........
X		 6) Auto baud detect ...... N
X		 7) 300 baud connect ...... CONNECT
X		 8) 1200 baud connect ..... CONNECT
X		 9) 2400 baud connect .....
X		10) 4800 baud connect .....
X		11) 9600 baud connect .....
X		12) 19200 baud connect ....
X		13) No connect string 1 ...
X		14) No connect string 2 ...
X		15) No connect string 3 ...
X		16) No connect string 4 ...
X
X	----------------------------------------------------------------
X	OPTION ==> _                               Press <ESC> to return
X
X	The relevant fields of the modem setup are:
X
X		1) Modem name.  This must be "OBM".
X
X	NOTE:  Pcomm uses the modem name as a flag  to  determine  which
X	dialing  method  to  use.  The string "OBM" is a "reserved word"
X	that Pcomm uses to switch to  the  AT&T Unix PC 7300/3b1 dialing
X	method.
X
X		3) Dialing command.  This should be "%" for  touch  tone
X		dialing or "^" for pulse dialing.
X
X		4) Dialing cmd suffix.  This must be the "@" character.
X
X		6) Auto baud detect.  The OBM cannot  use  the auto baud
X		detect feature.
X
X		7-8) Connect strings.  Although the OBM doesn't actually
X		return any result codes, these fake fields are required.
X
X	Additional OBM dialing codes from the phone(7) manual:
X
X		"~"	wait for next dial tone
X		","	pause 2 seconds
X		":"	pause 10 seconds
X		"&"	perform a hookflash
X		"%"	begin tone dialing
X		"^"	begin pulse dialing
X
X	These codes can be inserted into the phone  number  string,  for
X	example:
X
X		555-1234~56	dial 555-1234, wait for tone, dial 56
X		9,555-1234	dial 9, wait 2 seconds, dial 555-1234
X		%555^1234	dial 555 using tone, 1234 using pulse
X
X	NOTE:  The  dialing  codes  for  the  OBM  are  not  subject  to
X	character  synonym translations, therefore the "%", "^", and "~"
X	characters do NOT have to be preceded by the  "\"  character  to
X	remove their special meaning.
X
X	Appendix C
X
X			   Using Telebit Trailblazers
X
X	The Telebit Trailblazer modem is probably representative of  the
X	newer   high   speed  intelligent  modems  available  today  and
X	therefore warrants a more detailed discussion.
X
X	1) Locked interface speed
X
X		Trailblazers have  the  ability  to  maintain  a  locked
X		interface  speed with the computer without regard to the
X		connected baud rate.  For example, some people  find  it
X		necessary  to  lock the interface speed at 9600 baud (or
X		some other speed) for normal operations.  However, Pcomm
X		assumes the interface speed is the same as the connected
X		baud rate.
X
X		The "init speed" field of the TTY database  was  created
X		to solve this problem.  If this value is non-zero, Pcomm
X		will send the initialization string to the modem at this
X		baud  rate.   Normally, Pcomm would use the baud rate in
X		the dialing directory to send the init string.
X
X		The init string would now contain the  codes  to  unlock
X		the  interface,  enter the autobaud mode on receipt of a
X		break, and arrange for the loss of the DTR to return the
X		modem   to  its  previous  locked  state.   For  Telebit
X		Trailblazers this would be S66=0, S51=255, and S52=2.
X
X	2) Multiple setups
X
X		Users of Trailblazers often require  a  different  "init
X		string"  or  "dial  string" depending on the target baud
X		rate.  For example, the init strings for 9600 and  19200
X		baud may contain the command "S50=255" (to  wait for the
X		Telebit PEP tones) whereas the slower init strings would
X		contain "S50=0".
X
X		This problem is solved by creating an  additional  modem
X		entry  in  the  modem  database.  For example, you could
X		have an entry called "TELEBIT" for  baud  rates  in  the
X		range    of    300-2400   and   another   entry   called
X		"FAST_TELEBIT"  for  baud  rates   in   the   range   of
X		9600-19200.
X
X		Pcomm uses the connect strings to determine if the modem
X		can   handle  the  requested  baud  rate.   So,  if  the
X		"TELEBIT" entry had connect strings for 300,  1200,  and
X		2400  baud  it  would  be selected only if the requested
X		baud rate was in that range.  Likewise, the FAST_TELEBIT
X		would have connect strings only for 9600 and 19200 baud.
X
X	3) Baud rate synchronization
X
X		In contrast to the Hayes  2400  modem,  the  Trailblazer
X		does  not  immediately  synchronize with the serial port
X		when the baud rate is changed during the modem's command
X		mode.
X
X		To solve this problem, the init string and  dial  string
X		should contain the break character synonym followed by a
X		sufficient  number  of  A's  to  allow  the   modem   to
X		synchronize.   The default character synonym for a modem
X		break is the "%".
X
X	4) Sample TTY database
X
X		The following is the contents of the sample TTY database:
X
X		TTY name	Modem name	Init speed
X
X		1) tty10	HAYES		   0
X		2) tty11	HAYES		   0
X		3) tty12	DIRECT		   0
X		4) tty13	TELEBIT		   0
X		5) tty13	FAST_TELEBIT	   0
X
X		Notice that entries 4 and 5 share the same TTY.
X
X	NOTE:  The examples assume the  modem  interface  speed  is  not
X	locked.  See paragraph 1 for additional codes to be added to the
X	init string if the lock interface feature is used.
X
X	5) Sample modem database entry for TELEBIT
X
X		The third entry in the sample modem database is for  the
X		Telebit Trailblazer designated for use at slow speeds.
X
X		1) Modem name (3 of 4) .... TELEBIT
X		2) Modem init string ...... %AAAAAATS50=0S2=43S95=0M1!
X		3) Dialing command ........ %AAAAAATDTW
X		4) Dialing cmd suffix ..... !
X		5) Hang up string ......... ~~+++~~ATH0!
X		6) Auto baud detect ....... Y
X		7) 300 baud connect ....... CONNECT 300
X		8) 1200 baud connect ...... CONNECT 1200
X		9) 2400 baud connect ...... CONNECT 2400
X		10) 4800 baud connect .....
X		11) 9600 baud connect .....
X		12) 19200 baud connect ....
X		13) No connect string 1 ... BUSY
X		14) No connect string 2 ... ERROR
X		15) No connect string 3 ... NO CARRIER
X		16) No connect string 4 ...
X
X	6) Sample modem database entry for FAST_TELEBIT
X
X		The 4th entry is for the Telebit Trailblazer  designated
X		for use at higher speeds.
X
X		1) Modem name (4 of 4) .... FAST_TELEBIT
X		2) Modem init string ...... %AAAAAATS50=255S2=43S95=0M1!
X		3) Dialing command ........ %AAAAAATDTW
X		4) Dialing cmd suffix ..... !
X		5) Hang up string ......... ~~+++~~ATH0!
X		6) Auto baud detect ....... N
X		7) 300 baud connect .......
X		8) 1200 baud connect ......
X		9) 2400 baud connect ......
X		10) 4800 baud connect .....
X		11) 9600 baud connect ..... CONNECT
X		12) 19200 baud connect .... CONNECT
X		13) No connect string 1 ... BUSY
X		14) No connect string 2 ... ERROR
X		15) No connect string 3 ... NO CARRIER
X		16) No connect string 4 ...
echo shar: "48 control characters may be missing from 'Doc'"
SHAR_EOF
if test 61114 -ne "`wc -c < 'Doc'`"
then
	echo shar: "error transmitting 'Doc'" '(should have been 61114 characters)'
fi
fi
exit 0
#	End of shell archive


